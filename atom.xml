<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Wonderland</title>
  <icon>https://github.com/waynexia.png</icon>
  
  <link href="https://waynexia.github.io/atom.xml" rel="self"/>
  
  <link href="https://waynexia.github.io/"/>
  <updated>2023-01-02T06:28:43.264Z</updated>
  <id>https://waynexia.github.io/</id>
  
  <author>
    <name>Wayne</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>The Hidden Control Flow</title>
    <link href="https://waynexia.github.io/2022/12/async-cancellation/"/>
    <id>https://waynexia.github.io/2022/12/async-cancellation/</id>
    <published>2022-12-04T16:06:19.000Z</published>
    <updated>2023-01-02T06:28:43.264Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a>The Problem</h1><p>This post is talking about a â€œweirdâ€ <a target="_blank" rel="noopener" href="https://github.com/GreptimeTeam/greptimedb/issues/350">problem</a> we encountered in <a target="_blank" rel="noopener" href="https://github.com/GreptimeTeam/greptimedb">GreptimeDB</a>. And, a little spoiler, itâ€™s about the â€œasync cancellationâ€.</p><p>Letâ€™s first describe the (simplified) scenario. We observed metadata corruption in a long-run test. A series number is duplicated, but it should be increased monotonously. The update logic is very straightforward â€“ load value from an in-memory atomic counter, persist the new series number to file, and then update the in-memory counter. The entire procedure is serialized (<code>file</code> is a mutable reference):</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">update_metadata</span></span>(file: &amp;<span class="hljs-keyword">mut</span> File, counter: AtomicU64) -&gt; <span class="hljs-built_in">Result</span>&lt;()&gt; &#123;<br>    <span class="hljs-keyword">let</span> next_number = counter.load(Ordering::Relaxed) + <span class="hljs-number">1</span>;<br>    persist_number(file, number).<span class="hljs-keyword">await</span>?;<br>    counter.fetch_add(<span class="hljs-number">1</span>, Ordering::Relaxed);<br>&#125;<br></code></pre></td></tr></table></figure><p>For some reason, we are not using <code>fetch_add</code> here, though it does work, and if weâ€™ve done so, then the story wonâ€™t happen ğŸ¤ª For example, we donâ€™t want to update the in-memory counter when this procedure fails halfway, like operation <code>persist_number()</code> cannot write to the file. Here the sweet sugar <code>?</code> stands for such a situation. We know clearly that this function call may fail, and if it fails the caller returns early to propagate the error. So we will handle it carefully with that in mind.</p><p>But things become tricky with <code>.await</code>, the hidden control flow comes due to async cancellation.</p><h1 id="Async-Cancellation"><a href="#Async-Cancellation" class="headerlink" title="Async Cancellation"></a>Async Cancellation</h1><h2 id="async-task-and-runtime"><a href="#async-task-and-runtime" class="headerlink" title="async task and runtime"></a>async task and runtime</h2><p>If you have figured out the shape of the â€œcriminalâ€, you may want to skip this section. Instead, Iâ€™ll start with some pseudocode to show what happens in the â€œawait pointâ€, and how it interacts with the runtime. First is <code>poll_future</code>, it comes from the <code>Future</code>â€˜s <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/future/trait.Future.html#tymethod.poll"><code>poll</code></a> function, as every <code>async fn</code>â€˜s we write will be desugared to an anonymous <code>Future</code> implementation.</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">poll_future</span></span>() -&gt; FutureOutput &#123;<br>    <span class="hljs-keyword">match</span> status_of_the_task &#123;<br>        Ready(output) =&gt; &#123;<br>            <span class="hljs-comment">// the task is finished, and we have it output.</span><br>            <span class="hljs-comment">// some logic</span><br>            <span class="hljs-keyword">return</span> our_output;<br>        &#125;,<br>        Pending =&gt; &#123;<br>            <span class="hljs-comment">// it is not ready, we don&#x27;t have the output.</span><br>            <span class="hljs-comment">// thus we cannot make progress and need to wait</span><br>            <span class="hljs-keyword">return</span> Pending;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>async</code> block usually contains other async functions, like <code>update_metadata</code> and <code>persist_number</code>. Say <code>persist_number</code> is a sub-async-task of <code>update_metadata</code>. Each <code>.await</code> point will be expanded to something like <code>poll_future</code> â€“ <code>await</code>ing the subtaskâ€™s output and make progress when the subtask is ready. Here we need to wait <code>persist_number</code>â€˜s task returns <code>Ready</code> before we update the counter, otherwise we cannot do it.</p><p>And the second one is a (toy) runtime, which is in response to poll futures delivered to it. In GreptimeDB we use <a target="_blank" rel="noopener" href="https://docs.rs/tokio/latest/tokio/"><code>tokio</code></a> as our runtime. An async runtime may have tons of features and logic, but the most basic one is to poll: as the name tells, keep running unfinished tasks until they finish (but consider the things Iâ€™m going to write later, the â€œuntilâ€ might not be a proper word).</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">runtime</span></span>(&amp;<span class="hljs-keyword">self</span>) &#123;<br>    <span class="hljs-keyword">loop</span> &#123;<br>        <span class="hljs-keyword">let</span> future_tasks: <span class="hljs-built_in">Vec</span>&lt;Task&gt; = <span class="hljs-keyword">self</span>.get_tasks();<br>        <span class="hljs-keyword">for</span> task <span class="hljs-keyword">in</span> tasks &#123;<br>            <span class="hljs-keyword">match</span> task.poll_future()&#123;<br>                Ready(output) =&gt; &#123;<br>                    <span class="hljs-comment">// this task is finished. wake it with the result</span><br>                    task.wake(output);<br>                &#125;,<br>                Pending =&gt; &#123;<br>                    <span class="hljs-comment">// this task needs some time to run. poll it later</span><br>                    <span class="hljs-keyword">self</span>.poll_later(task);<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>That is it, a very minimalist model of future and runtime. Combining these two functions, you will find that in some aspects, it is just a loop (again, Iâ€™ve omitted lots of details to keep tight on the topic; the real world is way more complex). I want to stress the thing that each <code>.await</code> imply one or more function calls (call to <code>poll()</code> or <code>poll_future()</code>). This is the â€œhidden control flowâ€ in the title and the place cancellation takes effort.</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">run</span></span>() &#123;<br>    <span class="hljs-keyword">loop</span> &#123;<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> Ready(result) = task.poll() &#123;<br>            <span class="hljs-keyword">break</span> result;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Know it is not hard, but thinking about it is not easy (at least for me). Iâ€™ve stared at these lines for minutes after I narrow the scope down to as simple as the first code snippet. I know the problem is definitely in the <code>.await</code>. But donâ€™t know whether too many successful async calls have numbed me or my mental model hasnâ€™t linked these two points. The bulky garbage, me, spent a whole sleepless night doubting life and the world.</p><h2 id="cancellation"><a href="#cancellation" class="headerlink" title="cancellation"></a>cancellation</h2><p>So far is the standard part. We will then talk about cancellation, which is runtime-dependent. Though many runtimes in rust have similar behavior, this is not a required feature, i.e., a runtime can not support cancellation at all like <a target="_blank" rel="noopener" href="https://github.com/waynexia/texn">this toy</a>. And Iâ€™ll take tokio as an example because the story happens there. Other runtimes may be similar.</p><p>In tokio, one can use <a target="_blank" rel="noopener" href="https://docs.rs/tokio/latest/tokio/task/struct.JoinHandle.html#method.abort"><code>JoinHandle::abort()</code></a> to cancel a task. Tasks have a â€œcancel marker bitâ€ tracks whether itâ€™s cancelled. And if the runtime finds a task is cancelled, it will kill that task (code from <a target="_blank" rel="noopener" href="https://github.com/tokio-rs/tokio/blob/00bf5ee8a855c28324fa4dff3abf11ba9f562a85/tokio/src/runtime/task/state.rs#L283-L291">here</a>):</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-comment">// If the task is running, we mark it as cancelled. The thread</span><br><span class="hljs-comment">// running the task will notice the cancelled bit when it</span><br><span class="hljs-comment">// stops polling and it will kill the task.</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// The set_notified() call is not strictly necessary but it will</span><br><span class="hljs-comment">// in some cases let a wake_by_ref call return without having</span><br><span class="hljs-comment">// to perform a compare_exchange.</span><br>snapshot.set_notified();<br>snapshot.set_cancelled();<br></code></pre></td></tr></table></figure><p>The theory behind async cancellation is also elementary. Itâ€™s just the runtime gives up to keep polling your task when itâ€™s not yet finished, just like <code>?</code> or even tougher because we cannot catch this cancellation like <code>Err</code>. But does it means that we need to take care of every single <code>.await</code>? It would be very annoying. Take this metadata updating as an example. If we have to consider this, we need to check if the file is consistent with the memory state and revert the persisted change if found inconsistency. Wellâ€¦ ğŸ«  In some aspects, yes. The runtime can literally do anything to your future. But the good thing is that most of them are disciplined.</p><h1 id="Runtime-Behavior"><a href="#Runtime-Behavior" class="headerlink" title="Runtime Behavior"></a>Runtime Behavior</h1><p>This section will discuss what I would expect from a runtime and what we can get for now.</p><h2 id="marker-trait"><a href="#marker-trait" class="headerlink" title="marker trait"></a>marker trait</h2><p>I want the runtime not to cancel my task unconditionally and turn to the type system for help. This is wondering if there is a marker trait like <code>CancelSafe</code>. For the word cancellation safety, tokio has said about it in its <a target="_blank" rel="noopener" href="https://docs.rs/tokio/latest/tokio/macro.select.html#cancellation-safety">documentation</a>:</p><blockquote><p>To determine whether your own methods are cancellation safe, look for the location of uses of  <code>.await</code> . This is because when an asynchronous method is cancelled, that always happens at an  <code>.await</code> . If your function behaves correctly even if it is restarted while waiting at an  <code>.await</code> , then it is cancellation safe.  </p></blockquote><p>That is, whether a task is safe to be cancelled. This is definitely an â€œattributeâ€ of an async task. You can find that tokio has a long list of what is safe and what isnâ€™t in the library from the above link. And, in some ways, I think itâ€™s just like the <a href="jhttps://doc.rust-lang.org/std/panic/trait.UnwindSafe.html"><code>UnwindSafe</code></a> marker. Both are â€œ<em>this sort of control flow is not always anticipated</em>â€œ and â€œ<em>has the possibility of causing subtle bugs</em>â€œ.</p><p>With such a <code>CancelSafe</code> trait, we can tell the runtime if our spawned future is ok to be cancelled, and we promise the â€œcancellingâ€ control flow is carefully handled. And if without this, means we donâ€™t want the task to be cancelled. Simple and clear. This is also an approach for the runtimes to require their users (like you and me) to check if their tasks are able to be cancelled. Take <code>timeout()</code> as an example:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-comment">/// The marker trait</span><br><span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">CancelSafe</span></span> &#123;&#125;<br><br><span class="hljs-comment">/// Only cancellable task can be timeout-ed</span><br><span class="hljs-keyword">pub</span> <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">timeout</span></span>&lt;F&gt;(duration: Duration, future: F) -&gt; Timeout&lt;F&gt; <span class="hljs-keyword">where</span><br>    F: Future + CancelSafe<br>&#123;&#125;<br></code></pre></td></tr></table></figure><h2 id="volunteer-cancel"><a href="#volunteer-cancel" class="headerlink" title="volunteer cancel"></a>volunteer cancel</h2><p>Another approach is to cancel voluntarily. Like the <a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/cancellation-and-timeouts.html#cancellation-is-cooperative">cooperative cancellation in Kotlin</a>, it has an <a target="_blank" rel="noopener" href="https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/is-active.html"><code>isActive</code></a> method for a task to check if it is cancelled. And this is only a tester method, to cancel or not is fully dependent on the task itself. I paste an example from Kotlinâ€™s document below, the â€œcooperative cancellationâ€ happens in line 5. This way brings the â€œhidden control flowâ€ on the table and makes it more natural to consider and handle the cancellation just like <code>Option</code> or <code>Result</code>.</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> startTime = System.currentTimeMillis()<br><span class="hljs-keyword">val</span> job = launch(Dispatchers.Default) &#123;<br>    <span class="hljs-keyword">var</span> nextPrintTime = startTime<br>    <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> (isActive) &#123; <span class="hljs-comment">// cancellable computation loop</span><br>        <span class="hljs-comment">// print a message twice a second</span><br>        <span class="hljs-keyword">if</span> (System.currentTimeMillis() &gt;= nextPrintTime) &#123;<br>            println(<span class="hljs-string">&quot;job: I&#x27;m sleeping <span class="hljs-subst">$&#123;i++&#125;</span> ...&quot;</span>)<br>            nextPrintTime += <span class="hljs-number">500L</span><br>        &#125;<br>    &#125;<br>&#125;<br>delay(<span class="hljs-number">1300L</span>) <span class="hljs-comment">// delay a bit</span><br>println(<span class="hljs-string">&quot;main: I&#x27;m tired of waiting!&quot;</span>)<br>job.cancelAndJoin() <span class="hljs-comment">// cancels the job and waits for its completion</span><br>println(<span class="hljs-string">&quot;main: Now I can quit.&quot;</span>)<br></code></pre></td></tr></table></figure><p>And this is not hard to achieve in my opinion. Tokio already has the <a target="_blank" rel="noopener" href="https://github.com/tokio-rs/tokio/blob/00bf5ee8a855c28324fa4dff3abf11ba9f562a85/tokio/src/runtime/task/state.rs#L41"><code>Cancelled</code> bit</a> and <a target="_blank" rel="noopener" href="https://docs.rs/tokio-util/latest/tokio_util/sync/struct.CancellationToken.html"><code>CancellationToken</code></a>. But they look a bit different than what I describe. And after all of these, we need runtime to give the cancellation right back to our task. Or the situation might not have big difference.</p><h2 id="explicit-detach"><a href="#explicit-detach" class="headerlink" title="explicit detach"></a>explicit detach</h2><p>Can we force the runtime not to cancel our tasks at present? In tokio we can â€œdetachâ€ a task to the background by dropping the <code>JoinHandle</code>. A detached task means there is no foreground handle to the spawned task, and in some aspect, others cannot wrap a <code>timeout</code> or <code>select</code> over it, making it un-cancellable. And the problem in the very beginning is solved in this way.</p><blockquote><p>A  <code>JoinHandle</code>  <em>detaches</em> the associated task when it is dropped, which means that there is no longer any handle to the task, and no way to  <code>join</code> on it.  </p></blockquote><p>Though there is the functionality, I would wonder if itâ€™s better to have an explicit <code>detach</code> method like <a target="_blank" rel="noopener" href="https://docs.rs/glommio/0.7.0/glommio/struct.Task.html#method.detach"><code>glommio&#39;s</code></a>, or even a <code>detach</code> method in the runtime like <code>spawn</code>, which doesnâ€™t return the <code>JoinHandle</code>. But these are trifles. A runtime usually wonâ€™t cancel a task for no reason, and in most cases, itâ€™s required by the users. But sometimes you havenâ€™t noticed that, like those â€œunselect branchesâ€ in <code>select</code>, or the logic in <code>tonic</code>â€˜s request handler. And if we are sure that a task is ready for cancellation, explicit detach may prevent it from tragedy sometime.</p><h1 id="Back-To-The-Problem"><a href="#Back-To-The-Problem" class="headerlink" title="Back To The Problem"></a>Back To The Problem</h1><p>So far everything is clear. Letâ€™s start to wipe out this bug! First is, why our future is cancelled? Through the function call graph we can easily find the entire process procedure is executed in-place in <code>tonic</code>â€˜s request licensing runtime, and itâ€™s common for an internet request to have a timeout behavior. And the solution is also simple, just detaching the server processing logic into another runtime to prevent it from cancelled with the request. Only <a target="_blank" rel="noopener" href="https://github.com/GreptimeTeam/greptimedb/pull/376/files#diff-9756dcef86f5ba1d60e01e41bf73c65f72039f9aaa057ffd03f3fc2f7dadfbd0R46-R54">a few lines</a>:</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-meta">@@ -30,12 +40,24 @@</span> impl BatchHandler &#123;<br>         &#125;<br>         batch_resp.admins.push(admin_resp);<br><br><span class="hljs-deletion">-        for db_req in batch_req.databases &#123;</span><br><span class="hljs-deletion">-            for obj_expr in db_req.exprs &#123;</span><br><span class="hljs-deletion">-                let object_resp = self.query_handler.do_query(obj_expr).await?;</span><br><span class="hljs-deletion">-                db_resp.results.push(object_resp);</span><br><span class="hljs-addition">+        let (tx, rx) = oneshot::channel();</span><br><span class="hljs-addition">+        let query_handler = self.query_handler.clone();</span><br><span class="hljs-addition">+        let _ = self.runtime.spawn(async move &#123;</span><br><span class="hljs-addition">+            // execute request in another runtime to prevent the execution from being cancelled unexpected by tonic runtime.</span><br><span class="hljs-addition">+            let mut result = vec![];</span><br><span class="hljs-addition">+            for db_req in batch_req.databases &#123;</span><br><span class="hljs-addition">+                for obj_expr in db_req.exprs &#123;</span><br><span class="hljs-addition">+                    let object_resp = query_handler.do_query(obj_expr).await;</span><br><span class="hljs-addition">+</span><br><span class="hljs-addition">+                    result.push(object_resp);</span><br><span class="hljs-addition">+                &#125;</span><br>             &#125;<br></code></pre></td></tr></table></figure><p>Now all fine.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;The-Problem&quot;&gt;&lt;a href=&quot;#The-Problem&quot; class=&quot;headerlink&quot; title=&quot;The Problem&quot;&gt;&lt;/a&gt;The Problem&lt;/h1&gt;&lt;p&gt;This post is talking about a â€œweir</summary>
      
    
    
    
    
    <category term="Rust" scheme="https://waynexia.github.io/tags/Rust/"/>
    
  </entry>
  
  <entry>
    <title>Paper Reading: CURP protocol</title>
    <link href="https://waynexia.github.io/2022/09/curp-notes/"/>
    <id>https://waynexia.github.io/2022/09/curp-notes/</id>
    <published>2022-09-18T17:58:33.000Z</published>
    <updated>2023-01-02T06:28:43.264Z</updated>
    
    <content type="html"><![CDATA[<p>è®ºæ–‡åå­—æ˜¯ã€ŠExploiting Commutativity For Practical Fast Replicationã€‹</p><p>CURPå…¨ç§°Consistent Unordered Replication Protocolï¼Œä¸»è¦æ˜¯åˆ©ç”¨æ“ä½œä¹‹é—´çš„ç›¸å…³æ€§ï¼ˆCommutativeï¼‰æ¥å®ç°å±€éƒ¨ä¹±åºæäº¤çš„åè®®ã€‚è¿™é‡ŒCommutativeæŒ‡çš„æ˜¯ä¸åŒæ“ä½œè®°å½•ä¹‹é—´æ˜¯å¦å¯ä»¥äº¤æ¢æ‰§è¡Œé¡ºåºè€Œä¸å½±å“æœ€ç»ˆç»“æœï¼Œæ¯”å¦‚<code>x=1</code>ã€<code>y=2</code>å’Œ<code>x=3</code>ä¸‰æ¡è®°å½•ä¸­<code>y=2</code>ä¸å…¶ä»–ä¸¤æ¡éƒ½æ˜¯æ— å…³çš„ï¼Œæ»¡è¶³Commutativeå¯ä»¥ä¹±åºæ‰§è¡Œï¼Œè€Œ<code>x=1</code>ä¸<code>x=3</code>ä¹‹é—´æœ‰å…³ç³»ï¼Œéœ€è¦ä¸€ä¸ªç¡®å®šçš„æ‰§è¡Œé¡ºåºã€‚</p><p>ç›¸æ¯”äºå…¶ä»–çš„å¤åˆ¶åè®®ï¼ŒCURPçš„ç‰¹ç‚¹æ˜¯å¯¹äºæ»¡è¶³Commutativeçš„è®°å½•å¯ä»¥ä»¥1 RTTçš„å»¶æ—¶å®Œæˆæäº¤ã€‚</p><h1 id="é›†ç¾¤è§’è‰²"><a href="#é›†ç¾¤è§’è‰²" class="headerlink" title="é›†ç¾¤è§’è‰²"></a>é›†ç¾¤è§’è‰²</h1><p>é™¤äº†å¸¸è§çš„<code>Client</code>ï¼Œ<code>Leader</code>ï¼Œ<code>Backup</code>ä¹‹å¤–CRUPä¸­è¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°çš„<code>Witness</code>è§’è‰²ã€‚ç®€å•æ¦‚æ‹¬ä¸€ä¸‹è¿™äº›è§’è‰²ï¼š</p><ul><li><code>Client</code><ul><li>ä¸<code>Witness</code>å’Œ<code>Leader</code>äº¤äº’ï¼Œå¯¹<code>Witness</code>çš„é€šä¿¡æ˜¯å¹¿æ’­çš„å½¢å¼(åŒæ—¶ä¸æ‰€æœ‰<code>Witness</code>é€šä¿¡)  </li><li>è‡ªå·±ä¹Ÿæœ‰ä¸€å®šçš„çŠ¶æ€ï¼Œä¸»è¦æ˜¯å…³äºæ“ä½œçš„æ‰§è¡Œæƒ…å†µçš„ã€‚</li></ul></li><li><code>Witness</code>  <ul><li>CURPåè®®å®šä¹‰çš„è§’è‰²ï¼Œå­˜åœ¨å¤æ•°ä¸ªå®ä¾‹ï¼Œä¸”å®ä¾‹ä¹‹é—´å¯¹ç­‰  </li><li>æœ‰å­˜å‚¨èƒ½åŠ›æ¥ä¸´æ—¶å­˜å‚¨è¿‘æœŸçš„æ“ä½œè®°å½•ï¼Œä½†ä¸éœ€è¦ç»´æŠ¤çŠ¶æ€æœºï¼ˆæ“ä½œç»“æœï¼‰ï¼Œå°±æ˜¯ä¸€ä¸ªWAL</li><li>éœ€è¦æ„ŸçŸ¥å…·ä½“çš„æ“ä½œå†…å®¹å¹¶åˆ¤æ–­æ“ä½œä¹‹é—´æ˜¯å¦æœ‰å¯äº¤æ¢æ€§(commutative)  </li><li>å®ä¾‹é—´ç‹¬ç«‹è¿ä½œåŠå†³ç­–ï¼Œä¹Ÿç‹¬ç«‹äº<code>Leader</code>/<code>Backup</code>ã€‚</li></ul></li><li><code>Leader</code><ul><li>é›†ç¾¤ä¸»èŠ‚ç‚¹ï¼Œæœ‰å…¶ä»–ä¸»å¤‡åè®®ä¸­å¸¸è§çš„<code>Leader</code>çš„èƒ½åŠ›(ç»´æŠ¤çŠ¶æ€æœºï¼Œç­”å¤è¯»å†™è¯·æ±‚ï¼Œæ•°æ®åŒæ­¥ç­‰)  </li><li>åŒæ ·éœ€è¦æ„ŸçŸ¥å…·ä½“æ“ä½œå¹¶åˆ¤æ–­å¯äº¤æ¢æ€§</li><li>å¯ä»¥åœ¨æŠŠæ“ä½œåŒæ­¥ç»™<code>Backup</code>ä¹‹å‰ç­”å¤è¯·æ±‚</li><li>è®ºæ–‡ä¸­å«<code>Master</code></li></ul></li><li><code>Backup</code><ul><li>æ™®é€šçš„backupè§’è‰²</li></ul></li></ul><p>åœ¨è®ºæ–‡çš„æ­£æ–‡éƒ¨åˆ†ä¸­<code>Witness</code>éƒ½æ˜¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„éƒ¨ç½²å®ä¾‹æ¥è®¨è®ºçš„ï¼Œä¸è¿‡é™„å½•é‡Œä¹Ÿæåˆ°å®è·µä¸­ä¹Ÿæ²¡å¿…è¦å°†<code>Witness</code>å•ç‹¬éƒ¨ç½²ï¼Œè€Œæ˜¯è·Ÿç€<code>Leader</code>/<code>Backup</code>ä¸€èµ·è¿ä½œï¼Œåªä½œä¸ºé€»è¾‘ä¸Šçš„ä¸€ä¸ªç‹¬ç«‹å•å…ƒã€‚æ‰€ä»¥ä¸€äº›RPCè¯·æ±‚å®é™…ä¸Šæ˜¯å¯ä»¥åˆå¹¶ï¼ˆæ¯”å¦‚<code>Client</code>åŒæ—¶è¯·æ±‚<code>Leader</code>å’Œä¸å…¶åœ¨ä¸€èµ·çš„<code>Witness</code>ï¼‰æˆ–è€…æ˜¯æœ¬åœ°IPCï¼ˆæ¯”å¦‚<code>Leader</code>/<code>Backup</code>è¯·æ±‚å¯¹åº”çš„<code>Witness</code>ï¼‰çš„ã€‚å› æ­¤å¯¹äºå®é™…ä½¿ç”¨çš„æ—¶å€™æ¥è¯´<code>Witness</code>æ›´åƒæ˜¯CURPå¼•å…¥çš„æ–°æœºåˆ¶çš„ä¸€ä¸ªæ¦‚æ‹¬æŠ½è±¡ã€‚</p><h1 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h1><p>åè®®çš„å…·ä½“å†…å®¹å¯ä»¥ä»å‡ ä¸ªåŸºæœ¬æ“ä½œæ¥è¯´æ˜</p><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>ç”±<code>Client</code>å‘èµ·ï¼Œ<code>Client</code>åŒæ—¶å¯¹<code>Leader</code>åŠ<strong>æ‰€æœ‰</strong><code>Witnesses</code>å‘å‡ºè¯·æ±‚ï¼Œæ ¹æ®è¿™ä¸ªè¯·æ±‚ä¸ä¹‹å‰çš„è¯·æ±‚æ˜¯å¦æ— å…³(å¯äº¤æ¢ï¼Œcommutative)æœ‰ä¸¤ç§æƒ…å†µï¼š  </p><ul><li>å¦‚æœæ— å…³ï¼Œé‚£ä¹ˆ<code>Leader</code>å’Œ<strong>æ‰€æœ‰</strong><code>Witnesses</code>éƒ½ä¼šacceptè¿™ä¸ªè¯·æ±‚ã€‚<code>Client</code>åœ¨æ”¶åˆ°<strong>å…¨éƒ¨</strong>çš„acceptç­”å¤ä¹‹åå¯ä»¥å½“è¿™ä¸ªè¯·æ±‚å·²å®Œæˆã€‚</li><li>å¦‚æœ<code>Leader</code>æˆ–ä»»æ„ä¸€ä¸ª <code>Witness</code> è®¤ä¸ºæœ‰å…³(not commutative)ï¼Œ<code>Client</code>éƒ½éœ€è¦è¦æ±‚<code>Leader</code>è¿›è¡Œä¸€æ¬¡syncï¼Œå°†çŠ¶æ€ä¸<code>Backups</code>è¿›è¡ŒåŒæ­¥åç­”å¤<code>Client</code>ã€‚<code>Client</code>å¯ä»¥ä¾æ®è¿™ä¸ªsyncè¯·æ±‚çš„ç­”å¤å°†è¯·æ±‚å®Œæˆï¼Œè¿™ç§æƒ…å†µä¸‹<code>Witness</code>çš„ç­”å¤æ²¡æœ‰å½±å“ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ¬¡æ“ä½œä»<code>Client</code>å‘èµ·åˆ°å®Œæˆä¸€å…±æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼š<code>Proposed</code>ï¼Œ<code>Unsynced</code>å’Œ<code>Synced</code>ã€‚<code>Client</code>ä¼šå¯¹é™¤äº†<code>Backup</code>ä¹‹å¤–çš„æ‰€æœ‰èŠ‚ç‚¹å‘èµ·è¯·æ±‚ï¼Œåœ¨ä¸Šé¢çš„ç¬¬ä¸€ç§æƒ…å†µä¸‹æˆä¸º<code>Unsynced</code>ï¼Œæ­¤æ—¶<code>Client</code>å·²ç»å¯ä»¥è®¤ä¸ºè¯¥æ“ä½œå®Œæˆï¼Œ<code>Leader</code>ä¹Ÿå¯ä»¥æŠŠæ“ä½œåº”ç”¨åˆ°çŠ¶æ€æœºä¸Šã€‚<code>Leader</code>åº”ç”¨<code>Unsynced</code>æ“ä½œçš„è¿‡ç¨‹å«åšâ€œæ¨æµ‹æ‰§è¡Œï¼ˆspeculative executionï¼‰â€ã€‚<code>Unsynced</code>çš„æ“ä½œä¼šåœ¨ä¸€ä¸‹æ¬¡æ”¶åˆ°syncè¯·æ±‚æ—¶å¾€<code>Backups</code>è¿›è¡ŒåŒæ­¥ï¼ŒåŒæ­¥å®Œæˆçš„æ“ä½œç§°ä¸º<code>Synced</code>ã€‚è€Œåœ¨ä¸Šé¢çš„ç¬¬äºŒç§æƒ…å†µä¸‹æ“ä½œä¼šè·³è¿‡<code>Unsynced</code>è¿™ä¸€æ­¥ã€‚</p><p>ä½†æ˜¯ä»<code>Leader</code>è§†è§’çœ‹ä¸€ä¸ªæ“ä½œåªè¦<code>Leader</code>è®¤ä¸ºæ˜¯commutativeçš„å®ƒå°±ä¼šåº”ç”¨åˆ°çŠ¶æ€æœºï¼Œä½†è¿™ä¸ªæ“ä½œå¯èƒ½ä¼šè¢«<code>Witness</code>æ‹’ç»ï¼ˆè®¤ä¸ºæ˜¯not commutativeï¼‰ã€‚è¿™æ—¶å€™éœ€è¦ä¾èµ–<code>Client</code>æ¥å‘èµ·syncè¯·æ±‚ï¼Œè¦æ±‚<code>Leader</code>ä¸<code>Backups</code>è¿›è¡ŒåŒæ­¥ã€‚</p><h2 id="Leader-æ•…éšœæ¢å¤"><a href="#Leader-æ•…éšœæ¢å¤" class="headerlink" title="Leader æ•…éšœæ¢å¤"></a>Leader æ•…éšœæ¢å¤</h2><p>æ–° <code>Leader</code> çš„äº§ç”Ÿ/æ¢å¤æœ‰ä¸¤æ­¥ï¼Œé¦–å…ˆåŒæ­¥ <code>Backup</code> çš„çŠ¶æ€ï¼Œç„¶åéšä¾¿æŒ‘ä¸€ä¸ª <code>Witness</code> æ¥é‡æ”¾æ²¡åŒæ­¥åˆ° <code>Backup</code> ä¸­çš„æ“ä½œã€‚</p><p>åŒæ­¥<code>Backup</code>çŠ¶æ€å°±è·å¾—äº†æ‰€æœ‰<code>Synced</code>çš„æ“ä½œï¼Œè€Œä»ä¸Šé¢çš„æ›´æ–°æµç¨‹å¯ä»¥çŸ¥é“<code>Unsynced</code>çš„æ“ä½œå­˜åœ¨äº<strong>å…¨éƒ¨</strong>çš„<code>Witnesses</code>ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œéšä¾¿æŒ‘ä¸€ä¸ª <code>Witness</code> éƒ½æœ‰å…¨éƒ¨æ‰€éœ€çš„ä¿¡æ¯ã€‚å¦å¤–<code>Unsynced</code>æ“ä½œåœ¨ä¸åŒçš„<code>Witnesses</code>ä¸Šæ‰€æäº¤çš„é¡ºåºå¯èƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥CURPè¦æ±‚åªæœ‰æ»¡è¶³commutativeå¯ä»¥ä¹±åºæ‰§è¡Œçš„æ“ä½œæ‰å¯ä»¥æ¨æµ‹æ‰§è¡Œã€‚</p><p>å¦å¤–è¿˜éœ€è¦è§£å†³<code>Backup</code>å’Œ<code>Witness</code>å¯èƒ½å­˜åœ¨é‡å¤è®°å½•çš„é—®é¢˜ï¼Œå¦‚æœå°†å·²ç»æ˜¯<code>Synced</code>çš„æ“ä½œå†è¿›è¡Œé‡æ”¾æ˜¯ä¼šå¯¼è‡´çŠ¶æ€é”™è¯¯çš„ã€‚å› æ­¤CURPéœ€è¦ä¿è¯æ¯ä¸ªæ“ä½œåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œç®€å•æ¥è¯´å°±æ˜¯è®©<code>Client</code>ç»™æ¯ä¸ªæ“ä½œåŠ ä¸Šä¸€ä¸ª<code>RPC ID</code>ã€‚</p><blockquote><p>To avoid duplicate executions of the requests that are already replicated to backups, CURP relies on exactly-once semantics provided by RIFL, which detects already executed client requests and avoids their re-execution</p></blockquote><p>å½“ç„¶å¦‚æœæ˜¯ä¸€ä¸ª <code>Backup</code> æˆä¸ºæ–° <code>Leader</code> å°±å¯ä»¥è·³è¿‡ç¬¬ä¸€æ­¥ã€‚</p><h2 id="è¯»å–"><a href="#è¯»å–" class="headerlink" title="è¯»å–"></a>è¯»å–</h2><p><code>Client</code> å¯ä»¥ç›´æ¥ä» <code>Leader</code> è¯»ï¼Œä¸è¿‡éœ€è¦è¿™æ¬¡è¯»æ“ä½œä¹Ÿä¸å…¶ä»– <code>Unsynced</code> çš„æ“ä½œæ— å…³ï¼Œå¦åˆ™éœ€è¦å…ˆ sync ä¸€ä¸‹ï¼Œå› ä¸ºå¯¹åŒä¸€ä¸ªå†…å®¹çš„è¯»å’Œå†™æ“ä½œæ˜¯æ— æ³•ä¹±åºæ‰§è¡Œçš„ã€‚è€Œåœ¨<code>Leader</code>è§†è§’çœ‹ï¼Œæ¨æµ‹æ‰§è¡Œçš„æ“ä½œä¸ä¸€å®šåœ¨é‡å¯/å˜æ›´Leaderä¹‹åè¿˜å­˜åœ¨ï¼ˆåœ¨<code>Leader</code>åº”ç”¨åˆ°çŠ¶æ€æœºåï¼Œä½†æ˜¯è¢«<code>Witnesses</code>è®°å½•ä¸‹æ¥ä¹‹å‰å‘ç”Ÿcrashï¼‰ï¼Œæ‰€ä»¥è¯»æ¨æµ‹æ‰§è¡Œçš„å†…å®¹ä¹Ÿéœ€è¦æ£€æŸ¥commutativeã€‚æ‰€ä»¥è¿™ç§è¯»æ“ä½œä¸æ›´æ–°æ“ä½œçš„åŒºåˆ«åªæœ‰(1)ä¸æ¶‰åŠ <code>Witness</code> (2)ä¸ä¼šå½±å“ <code>Leader</code> çš„çŠ¶æ€æœºï¼Œå› æ­¤ä¸éœ€è¦è¢«è®°å½•ã€‚</p><p><code>Client</code> ä¹Ÿå¯ä»¥ä» <code>Backup</code> è¯»ï¼Œä¸è¿‡è¯»ä¹‹å‰éœ€è¦å…ˆå‘ä¸€ä¸ª <code>Witness</code> è¯¢é—®è¿™ä¸ªæ“ä½œæ˜¯å¦ commutativeã€‚åªæœ‰åœ¨å¾—åˆ°è‚¯å®šç­”å¤çš„æƒ…å†µä¸‹æ‰å¯ä»¥è¯» <code>Backup</code>ï¼Œå¦åˆ™è¿˜æ˜¯åªèƒ½ä» <code>Leader</code> è¯»ã€‚å‰é¢è¦æ±‚ä¸€ä¸ªæ“ä½œè¢«è®°å½•åˆ°æ‰€æœ‰ <code>Witnesses</code> ä¹Ÿè€ƒè™‘åˆ°äº†è¿™é‡Œèƒ½å¤Ÿéšæ„è¯·æ±‚ <code>Witness</code> æ¥è¯¢é—® commutativeã€‚</p><p>åŒæ—¶å› ä¸º<code>Backups</code>ä¹‹é—´çš„çŠ¶æ€å¯èƒ½å› ä¸ºåŒæ­¥è¿›åº¦ä¸åŒè€Œå‡ºç°å·®å¼‚ï¼Œä¸ºäº†ä»ä»»æ„ä¸€ä¸ª <code>Backup</code> éƒ½èƒ½è¯»åˆ°åŒæ ·çš„ç»“æœï¼Œ<code>Backups</code> ä¹‹é—´è¿˜éœ€è¦æ„ŸçŸ¥äº’ç›¸çš„åŒæ­¥çŠ¶æ€(å³ä¸€ä¸ªæ“ä½œæ˜¯å¦è¢«æ‰€æœ‰çš„ <code>Backups</code> åŒæ­¥å®Œæˆ)ã€‚</p><blockquote><p>even if a value is replicated to some of backups, the value may get lost if the master crashes and a new master recovers from a backup that didnâ€™t receive the new value. A simple solution for this problem is that backups donâ€™t allow reading values that are not yet fully replicated to all backups.</p></blockquote><h2 id="GC"><a href="#GC" class="headerlink" title="GC"></a>GC</h2><p>è¿™é‡Œè®¨è®º<code>Witness&#39; records</code>å’Œ<code>RPC ID</code>ä¸¤ä¸ªèµ„æºçš„å›æ”¶ã€‚</p><p>ä»å‰é¢å¯çŸ¥ï¼Œ<code>Witness</code> åªæœ‰åœ¨æ–°è®°å½•ä¸ç°åœ¨æ‰€æœ‰è®°å½•éƒ½æ— å…³çš„æƒ…å†µä¸‹æ‰èƒ½ acceptã€‚æ‰€ä»¥ä¸ºäº†æé«˜æˆåŠŸç‡ <code>Witness</code> å¿…é¡»å°½å¿«ä¸¢æ‰ä¸å¿…è¦çš„æ•°æ®(è¢« <code>Leader</code> åŒæ­¥åˆ°äº† <code>Backups</code> ä¸Šï¼Œå³syncedçš„æ•°æ®)ã€‚åœ¨ CURP ä¸­ <code>Leader</code> ä¼šç»™ <code>Witness</code> å‘ GC æŒ‡ä»¤ï¼Œå‘Šè¯‰ <code>Witness</code> å“ªäº›æ“ä½œå·²ç»å®Œæˆäº†åŒæ­¥å¹¶å¯ä»¥ä¸¢å¼ƒã€‚</p><p>åœ¨ <code>Witness GC</code> å’Œæ›´ä¹‹å‰çš„æ•…éšœæ¢å¤ç¯èŠ‚éƒ½éœ€è¦å¯¹æ“ä½œè®°å½•è¿›è¡Œæ ‡è¯†ï¼ŒCPUP ä½¿ç”¨çš„æ˜¯ <code>RIFL</code> ä¸­çš„ <code>RPC ID</code> æ¥å®Œæˆã€‚å› ä¸ºè¿™ä¸ª ID æ˜¯ Client åˆ†é…çš„ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ç´¯è¿›ç¡®è®¤çš„æ–¹å¼è€Œå¿…é¡»å¯¹æ¯ä¸ª ID éƒ½è¿›è¡Œè®°å½•ã€‚æ­¤å¤– CURP è¿˜å¯¹ <code>RIFL</code> åšäº†ä¸€äº›æ”¹åŠ¨ï¼Œåœ¨è®ºæ–‡çš„ <em>é™„å½•Â§C.1</em> èŠ‚æœ‰å±•å¼€ï¼Œä¸»è¦æ˜¯ä¸ºäº†é€‚é… Witness æä¾›çš„ Recoveryã€‚</p><h1 id="è¿›é˜¶æ“ä½œ"><a href="#è¿›é˜¶æ“ä½œ" class="headerlink" title="è¿›é˜¶æ“ä½œ"></a>è¿›é˜¶æ“ä½œ</h1><p>ä»æ›´æ–°æ“ä½œçš„æ­¥éª¤å¯ä»¥çœ‹åˆ° <code>Client</code> å‘ <code>Witnesses</code> å†™æ•°æ®ä»¥åŠ <code>Leader</code> å‘ <code>Backups</code> åŒæ­¥çŠ¶æ€éƒ½æ˜¯æœ‰å…¨åŒæ­¥çš„è¦æ±‚çš„ï¼Œå³è¦æ±‚æ‰€æœ‰çš„è¯·æ±‚å¯¹è±¡éƒ½å®Œæˆæ‰èƒ½ç®—å®Œæˆï¼Œè€Œåé¢çš„æ•…éšœæ¢å¤å’Œè¯»å–æ“ä½œä¹Ÿéƒ½ç”¨åˆ°äº†è¿™ä¸€ç‚¹ã€‚</p><p>è¿™æ ·æ“ä½œåœ¨ç½‘ç»œåˆ†åŒºæˆ–è€…å•èŠ‚ç‚¹å¤„ç†æ…¢ä¹‹ç±»æƒ…å†µä¸‹çš„å¯ç”¨æ€§å’Œæ€§èƒ½æ˜¯æ¯”è¾ƒè®©äººæ‹…å¿ƒçš„ã€‚è®ºæ–‡åœ¨é™„å½•è¿˜å±•å¼€äº†å¦ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥è®© <code>Client</code> å‘ <code>Witnesses</code> å†™æ•°æ®æ—¶åªå¾—åˆ°<em>è¶…å¤§å¤šæ•°(superquorum)</em> <code>Witnesses</code> çš„ç­”å¤å°±è¡Œã€‚è¿™é‡Œâ€œè¶…å¤§å¤šæ•°â€çš„è®¡ç®—æ–¹å¼æ˜¯ $$superquorum=f+\lceil f/2 \rceil + 1$$ï¼Œå…¶ä¸­<code>f</code>æ˜¯èƒ½å®¹å¿å¤šå°‘èŠ‚ç‚¹æŒ‚æ‰çš„æ•°é‡ã€‚è¿™é‡Œæ¯”ä¼ ç»Ÿå¤šæ•°æ´¾è¿˜å¤šäº†ä¸€ä¸ªâ€œå°‘æ•°æ´¾çš„å¤§å¤šæ•°â€çš„åŸå› æ˜¯ä¸ºäº†æ•…éšœæ¢å¤æ—¶å‰©ä¸‹çš„ <code>Witnesses</code> ä¹‹é—´è¿˜èƒ½ä¿æŒå¤šæ•°æ´¾ã€‚</p><blockquote><p>The reason why CURP needs a superquorum instead of a simple majority is to ensure commutativity of replays from witnesses during recovery</p></blockquote><p>è€Œç›¸åº”çš„ï¼Œ<code>Leader</code>åœ¨æ¢å¤çš„æ—¶å€™ä»¥åŠ<code>Client</code>åœ¨è¯»<code>Backup</code>ä¹‹å‰æŸ¥è¯¢çš„æ—¶å€™éƒ½éœ€è¦æ”¶é›†å¤šæ•°æ´¾<code>Witnesses</code>çš„ç»“æœã€‚å…¶å®å°±æ˜¯ç‰ºç‰²äº†ä¸€äº›è¯»æ—¶çš„ä¾¿åˆ©æ€§æ¥ä¼˜åŒ–å†™çš„æ“ä½œã€‚</p><p>æ­¤å¤– <code>Leader</code> å‘ <code>Backups</code> åŒæ­¥æ•°æ®ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œåªè¦åŒæ­¥åˆ°å¤šæ•°æ´¾ä¸Šï¼Œåœ¨æ¢å¤çš„æ—¶å€™é€‰æœ€æ–°çš„ã€‚åœ¨ <code>Client</code> è¯» <code>Backup</code> çš„æ—¶å€™ä¹Ÿé€‰å¤šæ•°æ´¾å’Œæœ€æ–°ä»»æœŸï¼Œç±»ä¼¼ Raft çš„é‚£ä¸€å¥—æ“ä½œã€‚</p><h1 id="ä¸€äº›è¯æ˜"><a href="#ä¸€äº›è¯æ˜" class="headerlink" title="ä¸€äº›è¯æ˜"></a>ä¸€äº›è¯æ˜</h1><p>è®ºæ–‡åœ¨ <em>é™„å½•Â§A</em> é‡Œé¢ç®€å•è¯æ˜äº†ä¸€ä¸‹ <code>Durability</code>, <code>Consistency</code> å’Œ <code>Linearizability</code> å‡ ä¸ªå…³é”®ç‰¹æ€§ï¼Œä¸è¿‡éƒ½æ˜¯åŸºäºåŸºæœ¬æ“ä½œçš„ç‰ˆæœ¬ï¼ˆå…¨åŒæ­¥å†™ï¼‰ã€‚è¿™é‡Œä¹Ÿæ´—ä¸€ä¸‹ç¨¿ã€‚</p><p>å…ˆå›é¡¾ä¸€ä¸‹å‡ ä¸ªæ“ä½œæ—¶çš„è§„åˆ™ï¼š</p><ul><li><code>Client</code> åªæœ‰ä¸¤ç§æƒ…å†µä¸‹å¯ä»¥å®Œæˆä¸€ä¸ªæ“ä½œï¼šè¯¥æ“ä½œè¢«<strong>æ‰€æœ‰</strong> <code>Witnesses</code> è®°å½• <em>æˆ–</em> è¯¥æ“ä½œè¢«<strong>æ‰€æœ‰</strong> <code>Backups</code> æŒä¹…åŒ–(å³è¢« <code>Leader</code> æ¥æ”¶)<blockquote><p>from Â§3.2.1, a client only completes an update operation if (1) it is recorded in all f witnesses or (2) it is replicated to f backups.</p></blockquote></li><li>ä¸€ä¸ªæœªåŒæ­¥(unsynced)çš„æ“ä½œå¿…é¡»ä¸æ‰€æœ‰å…¶ä»–æœªåŒæ­¥çš„æ“ä½œæ— å…³(commutative)<blockquote><p>a completed unsynced operation must be individually commutative with all preceding operations that are not synced yet.</p></blockquote></li><li>å¦‚æœ <code>Leader</code> è¦ç­”å¤ä¸€ä¸ªä¸å¯äº¤æ¢(not commutative)çš„æ“ä½œï¼Œéœ€è¦å…ˆä¸ <code>Backup</code> è¿›è¡Œä¸€æ¬¡åŒæ­¥(sync)<blockquote><p>a master must sync before responding if the current operation is not commutative with any other existing (preceding) unsynced operations.</p></blockquote></li></ul><h2 id="Durability"><a href="#Durability" class="headerlink" title="Durability"></a>Durability</h2><p>æ‰€æœ‰çš„æ“ä½œè‡³å°‘ä¼šå­˜åœ¨äºæ‰€æœ‰ <code>Backups</code> (synced) æˆ–æ‰€æœ‰ <code>Witnesses</code> (unsynced) ä¸Šï¼Œæ‰€ä»¥æ¢å¤çš„æ—¶å€™æ‰¾ä¸€ä¸ª <code>Backup</code> åŠ ä¸Šä¸€ä¸ª <code>Witness</code> å°±èƒ½æ‹¿åˆ°æ‰€æœ‰çš„ä¿¡æ¯ã€‚</p><h2 id="Consistency"><a href="#Consistency" class="headerlink" title="Consistency"></a>Consistency</h2><p>synced çš„æ“ä½œå­˜åœ¨åœ¨ Backup ä¸Šï¼Œå¹¶é€šè¿‡ ID çš„æ–¹å¼é˜²æ­¢é‡å¤æ‰§è¡Œã€‚unsynced çš„æ“ä½œå­˜åœ¨åœ¨ Witness ä¸Šï¼Œå¹¶ä¸”å¯ä»¥ä»¥ä»»æ„é¡ºåºé‡æ”¾ã€‚</p><p>ä¸è¿‡è®ºæ–‡å¥½åƒæœ‰ä¸€ä¸ªå†…å®¹æ²¡è®²ï¼Œå°±æ˜¯ <code>Witness</code> ä¸Šè®°å½•çš„æ“ä½œä¸ä¸€å®šæœ€ç»ˆä¼šæ‰§è¡Œï¼ˆæ¯”å¦‚<code>Client</code>å‘èµ·syncä¹‹å‰å‘ç”Ÿcrashï¼‰ï¼Œæ‰€ä»¥ <code>Witness</code> æ˜¯éœ€è¦æœ‰æœºåˆ¶å»ç¡®è®¤ä¸€ä¸ªè®°å½•ä¸‹æ¥çš„æ“ä½œæ˜¯æœ‰æ•ˆçš„ã€‚æˆ‘è§‰å¾—å¯ä»¥è®© <code>Leader</code> å®šæœŸç»™ <code>Witness</code> åŒæ­¥è¿™ä¸ªä¿¡æ¯ï¼ˆæ¯”å¦‚å°†è¿™ä¸ªä¹Ÿä½œä¸º sync çš„ä¸€æ­¥ï¼‰ï¼ŒåŒæ—¶ <code>Witness</code> åœ¨æ¢å¤æœŸé—´ä¸æä¾›æœªè¢«ç¡®è®¤çš„æ“ä½œã€‚</p><h2 id="Linearizability"><a href="#Linearizability" class="headerlink" title="Linearizability"></a>Linearizability</h2><p>è¿˜æ˜¯ä»å‰é¢çš„è§„åˆ™æ¨å¯¼ã€‚å¦‚æœä¸€ä¸ªå†™å…¥åœ¨åªè¢«éƒ¨åˆ† <code>Witness</code> è®°å½•åˆ°çš„æ—¶å€™å°±crashï¼Œé‡å¯ä¹‹åçš„ <code>Leader</code> å¯èƒ½ä¸ä¼šæœ‰è¿™ä¸ªä¿¡æ¯ï¼Œä½†æ˜¯è¿™æ—¶å€™ <code>Client</code> ä¹Ÿä¸ä¼šè®¤ä¸ºè¿™ä¸ªæ“ä½œå·²å®Œæˆï¼Œå› ä¸ºæ²¡æ”¶åˆ°æ‰€æœ‰ <code>Witness</code> çš„ç­”å¤ã€‚å¯¹äº<code>Client</code>è®¤ä¸ºå·²ç»å®Œæˆçš„æ“ä½œå†å»è¯»çš„æ—¶å€™ <code>Leader</code> èƒ½ä¿è¯çº¿æ€§ä¸€è‡´ã€‚è¯» <code>Backup</code> çš„æµç¨‹è®ºæ–‡çš„å›¾4ä¹Ÿç¨å¾®æ¶‰åŠåˆ°äº†çº¿æ€§ä¸€è‡´çš„å‡ ç§æƒ…å†µã€‚</p><p>ä¸è¿‡è¿™é‡Œåªæ˜¯æ–‡å­—è®ºè¿°ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆå¹¶æ³•å†…å®¹ï¼Œä½œä¸ºè¯æ˜æ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹å•è–„ï¼Œä½†æ˜¯ä¹Ÿæƒ³ä¸åˆ°ä»€ä¹ˆåé¢ä¾‹å­â€¦â€¦</p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>è¿™ç¯‡æ–‡ç« çœç•¥äº†è®ºæ–‡ä¸­çš„ä¸€äº›å†…å®¹ï¼Œæ¯”å¦‚ä¸€äº›å®ç°ä¸Šçš„ç»éªŒç»†èŠ‚ï¼Œåˆ†åŒºçš„å¤„ç†ç­‰ç­‰ã€‚çœ‹ä¸‹æ¥è§‰å¾—åŸºæœ¬æ€æƒ³è¿˜å¥½ç†è§£ï¼Œè®ºæ–‡è¯´è¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„ä¼˜åŒ–æ‰‹æ®µï¼Œä½†æ˜¯æ€ä¹ˆå˜æˆä¸€ä¸ªçœŸæ­£çš„ä¼˜åŒ–æ„Ÿè§‰è¿˜æ˜¯è¦åœ¨å®ç°çš„æ—¶å€™å¤šåšäº›å¾®æ“â€¦â€¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è®ºæ–‡åå­—æ˜¯ã€ŠExploiting Commutativity For Practical Fast Replicationã€‹&lt;/p&gt;
&lt;p&gt;CURPå…¨ç§°Consistent Unordered Replication Protocolï¼Œä¸»è¦æ˜¯åˆ©ç”¨æ“ä½œä¹‹é—´çš„ç›¸å…³æ€§ï¼ˆCommu</summary>
      
    
    
    
    
    <category term="Paper Reading" scheme="https://waynexia.github.io/tags/Paper-Reading/"/>
    
  </entry>
  
  <entry>
    <title>reMarkable2 ä½¿ç”¨ä½“éªŒ</title>
    <link href="https://waynexia.github.io/2022/05/remarkable2/"/>
    <id>https://waynexia.github.io/2022/05/remarkable2/</id>
    <published>2022-05-04T01:37:44.000Z</published>
    <updated>2023-01-02T06:28:43.264Z</updated>
    
    <content type="html"><![CDATA[<p><em>é¢˜å›¾æ¥è‡ª<a href="remarkable.com">remarkable.com</a></em></p><h1 id="åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾"><a href="#åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾" class="headerlink" title="åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾"></a>åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾</h1><p>çŸ¥é“reMarkable2æ˜¯åœ¨æŸå¤©åˆ·æ¨çš„æ—¶å€™çœ‹è§äº†ä»–ä»¬æŠ•æ”¾çš„å¹¿å‘Šï¼Œçœ‹äº†ä¸¤å¤©ä¹‹åå°±å‰æ‰‹äº†ï¼Œéå¸¸å†²åŠ¨ã€‚ä¹‹å‰æ€€ç–‘å¹¿å‘Šæ˜¯ä¸æ˜¯çœŸçš„é‚£ä¹ˆæœ‰ç”¨ï¼Œæœ€åæ²¡æƒ³åˆ°ç”µè§†è´­ç‰©çš„ç«Ÿæ˜¯æˆ‘è‡ªå·±ã€‚</p><p>ä¸€ç›´è§‰å¾—çœ‹PDFå¾ˆä¸çˆ½ã€‚æ‰‹ä¸Šçš„è®¾å¤‡æœ‰å¤ªå°çš„kindleï¼Œå¤ªé‡çš„surfaceå’Œæ²¡æ„Ÿè§‰çš„ç”µè„‘å±å¹•ã€‚ä¸€ç›´æœ‰ç‚¹æƒ³å†æ•´ä¸€ä¸ªï¼Œä½†æ˜¯ä¹Ÿä¸€ç›´æ²¡ç‰¹åˆ«æƒ³ä¸‹æ‰‹ã€‚dpt-rp1çœ‹èµ·æ¥ç¡®å®ä¹Ÿå¾ˆä¸é”™ï¼Œä¸ä¸€å®šè¦å¢¨æ°´å±æ‰€ä»¥padä¹Ÿåœ¨è€ƒè™‘èŒƒå›´ã€‚è¿™ç§æƒ…å†µä¸‹å¯èƒ½æ¥ä¸‹æ¥åº”è¯¥è¯´çš„æ˜¯reMarkable2ä¸ºä»€ä¹ˆä¸ä¸€æ ·ï¼Œå¯æƒœçš„æ˜¯æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚å®ƒçš„å‡ ä¸ªäº®ç‚¹æ¯”å¦‚è–„å’Œæ‰‹å†™ä½“éªŒå¯¹æˆ‘éƒ½åªç®—â€œæœ‰äº†æ›´å¥½ï¼Œæ²¡æœ‰ä¹Ÿæ— æ‰€è°“â€çš„èŒƒç•´ï¼Œåªèƒ½è¯´æ˜¯å¹¿å‘ŠæŠ•æ”¾çš„æˆåŠŸå§ã€‚</p><h1 id="æ§½ç‚¹"><a href="#æ§½ç‚¹" class="headerlink" title="æ§½ç‚¹"></a>æ§½ç‚¹</h1><p>å› ä¸ºå…¥æ‰‹çš„æ—¶å€™å¯¹å®ƒçš„æœŸæœ›æ›´åå‘äºä¸€ä¸ªé˜…è¯»å™¨ï¼Œå¼€ç®±ç”¨äº†å‡ å¤©å°±æœ‰å¥½å¤šæƒ³åæ§½çš„åœ°æ–¹â€¦â€¦</p><ul><li><p>ç¿»ç›–æ­»è´µä½†æ˜¯åŠŸèƒ½éå¸¸å°‘ã€‚<br>æˆ‘è§‰å¾—è¿™ä¸ªç›–å­å°±æ˜¯ä¸€ä¸ªå¸¦ä¸¤å—ç£é“çš„å£³ï¼Œå®Œå…¨ä¸èƒ½ç®—æ˜¯ç”µå­é…ä»¶ã€‚æœºèº«ä¾§é¢ç•™æœ‰å‡ ä¸ªé‡‘å±è§¦ç‚¹ï¼Œä½†æ˜¯è¿™ä¸ªå£³å¯¹åº”çš„ä½ç½®å±…ç„¶ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚è€Œä¸”å£³æœ¬èº«å°é¢æœ‰ç£å¸ï¼Œä½†æ˜¯æœºå™¨ä¸èƒ½å“åº”ç¿»ç›–åŠ¨ä½œâ€¦â€¦è®©æŒ‰é”®ç„¦è™‘çš„äººéå¸¸éš¾å—ã€‚</p></li><li><p>æ²¡æœ‰èƒŒå…‰ç¯ã€‚<br>ä¸¤ä»£éƒ½æ²¡æœ‰ï¼Œä¸çŸ¥é“æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åŸå› ã€‚åœ¨æˆ‘çš„æ¡Œé¢ç¯å¢ƒä¸Šåªæœ‰ä¸€ä¸ªå±å¹•ç¯ï¼Œæ‰€ä»¥å½“æ™šä¸Šé åœ¨æ¤…å­ä¸Šä¸å¼€é¢å¤–å…‰æºåŸºæœ¬ä¸èƒ½çœ‹ã€‚ç»è¿‡äº†ä¸€ä¸ªé˜´å¤©ï¼Œå®¤å†…å…‰çº¿ç¨å¾®æš—ä¸€ç‚¹å°±è¦å¼€é¡¶ç¯ä½¿ç”¨äº†ã€‚</p></li><li><p>å±å¹•åˆ†è¾¨ç‡ä½ã€‚<br>è¿™ä¸ªä¸»æ¨çš„æ˜¯åƒçœŸçº¸ä¸€æ ·çš„ä¹¦å†™ä½“éªŒï¼Œä½†æ˜¯è°çš„çº¸èƒ½å¤Ÿâ€¦â€¦å†™å‡ºé”¯é½¿ï¼Ÿè®¾å¤‡ç¬¬ä¸€æ¬¡å¼€æœºçš„ç¬¬ä¸€ä¸ªç¯èŠ‚å°±æ˜¯è®©ä½ æ‹¿ç¬”ä½“éªŒä¸€ä¸‹ï¼Œç»“æœæˆ‘ä¸€åˆ’æ‹‰å‡ºæ¥ä¸€æ¡é”¯é½¿ï¼Œå½“åœºèšŒåŸ ä½äº†ã€‚</p></li><li><p>è½¯ä»¶ï¼ˆå›ºä»¶ï¼‰ä½“éªŒå¾ˆå·®ï¼Œè¿™ä¸ªåˆ†ä¸¤æ–¹é¢ã€‚</p><ul><li>é¦–å…ˆæˆ‘è§‰å¾—è¿™ä¸ªç³»ç»Ÿï¼ˆv2.12.3ï¼‰çš„åŸºæœ¬åŠŸèƒ½æ˜¯ç¼ºå¤±çš„ï¼Œæ¯”å¦‚ç¬”å±…ç„¶ä¸æ”¯æŒè°ƒèŠ‚å‹æ„Ÿçµæ•åº¦ï¼Œå¯¼è‡´æˆ‘åœ¨ä¹ æƒ¯çš„åŠ›é“ä¸‹åªæœ‰ä¸€ç§ç¬”è§¦èƒ½ä½¿ç”¨;è€Œä¸”ä½ ç”šè‡³ä¸èƒ½åœ¨PDFä¸Šé€‰æ‹©æ–‡å­—ï¼Œsuch a REMARKABLE tabletã€‚</li><li>ä»¥åŠä¸é‚£ä¹ˆåŸºæœ¬çš„åŠŸèƒ½ä¹Ÿæ˜¯ç¼ºå¤±çš„ï¼ˆå¯¹äºä¸æƒ³æ¯ä¸ªæœˆå†å¤šæ58.88 hkdä¸”ä¸æƒ³æŠ˜è…¾ç”¨æˆ·æ¥è¯´ï¼‰ã€‚é‚®ä»¶ä¼ è¾“ã€ä¸‰æ–¹å­˜å‚¨å’Œå±å¹•åˆ†äº«è¿™äº›åŠŸèƒ½éƒ½è¢«<em>remarkable.com</em>åˆ—ä¸ºäº†ä»˜è´¹è®¢é˜…å†…å®¹ã€‚</li></ul></li></ul><h1 id="è¿˜ä¸é”™çš„åœ°æ–¹"><a href="#è¿˜ä¸é”™çš„åœ°æ–¹" class="headerlink" title="è¿˜ä¸é”™çš„åœ°æ–¹"></a>è¿˜ä¸é”™çš„åœ°æ–¹</h1><p>ä¸»è¦ä½¿ç”¨åœºæ™¯æ˜¯æ‹¿æ¥çœ‹PDFï¼Œæ¯”èµ·æˆ‘çš„voyageç¡®å®å¤§äº†ä¸å°‘ï¼Œå±å¹•å°æ˜¯voyageçœ‹ä¸æ¥çš„å”¯ä¸€å› ç´ ã€‚ä½†æ˜¯å®é™…æ‹¿A4çº¸æ¯”äº†ä¸‹æ‰å‘ç°rm2ä¹Ÿåªä»…ä»…æ¯”A5å°ºå¯¸ç¨å®½ä¸€äº›ï¼Œä½†æ˜¯è£æ‰é¡µé¢è¾¹ç¼˜çš„ç•™ç™½ä¹‹åä¹Ÿèƒ½å¤Ÿå¾ˆèˆ’æœåœ°å±•ç¤ºä¸€é¡µçº¸çš„å†…å®¹äº†ï¼Œå½“ç„¶å­—è¿˜æ˜¯å˜å°äº†ä¸€äº›ã€‚</p><img class="url&#x3D;compare.jpg title&#x3D;å’Œkindle voyageä»¥åŠA5çº¸çš„å¯¹æ¯”ã€‚åŸºæœ¬åªæ¯”A5å®½å‡ æ¯«ç±³"><p>åœ¨è¿™ä¹‹å‰æƒ³è¦åœ¨kindleä¸Šçœ‹çº¸èˆ’æœä¸€ç‚¹ï¼Œå°è¯•è¿‡å„ç§æ–¹å¼è¯•å›¾é‡æ’PDFæ¥é€‚åº”kindleï¼Œä¹Ÿè®¸ç®€å•åœ°è£ä¸€ä¸‹åŠ ä¸Šæ¨ªå±å°±èƒ½è®©ä½“éªŒæå‡ä¸å°‘ã€‚</p><p>æ‹¿ç€ç¬”çš„æ—¶å€™ä¼šè‡ªç„¶åœ°æƒ³å†™å†™ç”»ç”»ã€‚å†™å¾—å¤ªä¸‘å°±ä¸å±•ç¤ºäº†ï¼Œç”»å°±åƒä¸‹é¢è¿™æ ·ï¼Œéå¸¸è‰ºæœ¯ã€‚ä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹ä¸ºä»€ä¹ˆåœ¨æ¿å­ä¸Šé¢å†™å­—å°±è¿™ä¹ˆéš¾çœ‹ï¼Œæœ€åå¾—å‡ºçš„ç»“è®ºæ˜¯æ¿å­çš„é—®é¢˜<del>ï¼ŒçœŸçš„</del>ã€‚å› ä¸ºå±å¹•æœ‰ä¸€å®šåšåº¦ï¼Œç¬”å°–æ¥è§¦åˆ°çš„ä½ç½®å’Œè®¾å¤‡ç”»å‡ºç¬”è§¦çš„ä½ç½®ä¹‹é—´å­˜åœ¨ä¸€ä¸ªå‚ç›´ä¸Šçš„è·ç¦»ã€‚å¦‚æœçœ¼ç›çœ‹æ¿å­çš„æ—¶å€™ä¸æ¿å¹³é¢æ³•çº¿å­˜åœ¨ä¸€ä¸ªè§’åº¦ï¼Œå°±ä¼šåœ¨è§†è§‰ä¸Šå¸¦æ¥ä¸€ä¸ªç¬”å°–å’Œç¬”è§¦çš„åå·®é‡ï¼Œæ„Ÿè§‰æœ€æ˜æ˜¾çš„æ˜¯ç”»ç”»çš„æ—¶å€™ä½ å¾ˆéš¾è®©ä¸¤æ¡çº¿å®Œç¾åœ°è¿æ¥èµ·æ¥ï¼Œå› ä¸ºä½ è§‰å¾—ä½ åº”è¯¥è½ç¬”çš„åœ°æ–¹å¹¶ä¸æ˜¯å¸¦ç”µç¢³ç²‰å‡ºæ¥çš„ä½ç½®ã€‚ç”šè‡³åœ¨Redditä¸Šçœ‹åˆ°ä¸€ä¸ªadviceï¼Œå¦‚æœä½ æ˜¯å³æ’‡å­çš„è¯å¯ä»¥å°è¯•å°†è®¾å¤‡çš„åå¥½è®¾ç½®è°ƒåˆ°å·¦æ’‡å­ï¼Œè¿™æ ·ç³»ç»Ÿå¯¹ç¬”è§¦è¿›è¡Œçš„ä¿®æ­£èƒ½å¤Ÿå‡è½»è¿™ä¸ªåç§»ç°è±¡ã€‚</p><img class="url&#x3D;doraemon.png title&#x3D;ç”»"><p>è€Œæˆ‘çš„å¯¹äºä¸ºä»€ä¹ˆå†™å­—ä¼šå˜ä¸‘çš„ç»“è®ºæ˜¯ï¼Œåœ¨æˆ‘å†™å­—çš„æ—¶å€™æ‰‹ä¼šå°è¯•å»å¼¥è¡¥è¿™ä¸ªåå·®é‡ä»è€Œå¯¼è‡´å†™å‡ºæ¥çš„ä¸œè¥¿å˜å½¢<del>ï¼ˆé€æ¸è¿œç¦»å°æ ‡é¢˜ï¼‰</del>ã€‚</p><p>å› ä¸ºç”»ç”»æŠ€èƒ½å®åœ¨å¤ªå·®ï¼Œä¸å¤ªå¥½è¯´çœŸæ‹¿è¿™ä¸ªå½“ç”»æ¿ä¼šæ˜¯ä»€ä¹ˆä½“éªŒï¼Œä¸è¿‡è¿˜æ˜¯è¦æä¸€ä¸‹ç”¨äº†ä¸€æ®µæ—¶é—´æ„Ÿè§‰åˆ°çš„è¿™ä¸ªè®¾å¤‡åœ¨è½¯ä»¶æ–¹é¢éš¾å¾—åšäº†çš„ä¸€ä»¶æå‡ä½“éªŒçš„åŠŸèƒ½ã€‚åœ¨ç”¨ç¬”ç¼–è¾‘çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å›¾å±‚åŠŸèƒ½ï¼Œæ¯”å¦‚ä¸Šé¢çš„Doraemonå’ŒNobitaå°±æ˜¯å…ˆç”»å¥½çœ¼çœ¶ï¼Œå†æ‹‰åˆ°å¦ä¸€ä¸ªå›¾å±‚å»æ¶‚çœ¼ç å­ï¼Œå¯ä»¥é˜²æ­¢ç”¨æ©¡çš®æ“¦çš„æ—¶å€™æŠŠå…¶ä»–å·²ç»ç”»å¥½çš„åœ°æ–¹æ“¦æ‰ã€‚</p><p>ä¸è¿‡åœ¨å¯¼å‡ºåˆ°åˆ«çš„è®¾å¤‡ä¸Šçš„æ—¶å€™ä¼šå‘ç°ç¬”è¿¹æœ‰äº›å¥‡æ€ªï¼Œæœ‰ç‚¹å–·ç²‰é¢œæ–™çš„æ„Ÿè§‰ã€‚å°±æ˜¯ä»ç“¶å­é‡Œé¢å–·å‡ºæ¥æ˜¯ç²‰æœ«ï¼Œæ‹¿ç«åŠ çƒ­ä¸€ä¸‹å°±ä¼šèåŒ–æˆé¢œæ–™é•€è†œçš„é‚£ç§ã€‚åœ¨è®¾å¤‡ä¸Šçœ‹èµ·æ¥åªæ˜¯æ¯”è¾ƒæµ…çš„ç¬”è¿¹ï¼Œå¯¼å‡ºæ¥ä¹‹åä¼šå˜å¾—å¥‡æ€ªåœ°åœ†æ¶¦èµ·æ¥ã€‚</p><h1 id="Workflow"><a href="#Workflow" class="headerlink" title="Workflow"></a>Workflow</h1><p>å¦‚æœæ˜¯çœ‹çº¸çš„è¯å°±è¾¹çœ‹è¾¹å†™å†™ç”»ç”»ï¼Œä¸è¿‡ç”±äºæ‰‹å†™è¯†åˆ«å·®ä¸å¤šå°±æ˜¯åªæœ‰è‹±æ–‡ï¼Œæ‰€ä»¥å¾—è¦èµ›åšèªŠå†™ä¸€ä¸‹ã€‚ä»ç™½çº¸å¼€å§‹çš„è‰ç¨¿å°±å½“ä½œæ˜¯å†™åœ¨çº¸ä¸Šäº†ï¼Œæœ€åè¿˜æ˜¯æ‹¿ç”»å›¾æ¿é‡æ–°ç”»ä¸€æ¬¡ï¼ˆå½“ç„¶æ‰‹ç»˜çš„ä¸œè¥¿ä¹Ÿå¤ªéš¾çœ‹è€Œä¸èƒ½ç›´æ¥æ‹¿å‡ºæ¥ç”¨ï¼‰ã€‚æ‹¿è¿™ä¸ªå†™å†™ç”»ç”»çš„æ—¶å€™ä½“éªŒè¿˜è¡Œï¼Œä¸åŒçš„äº‹æƒ…å•ç‹¬å¼€ä¸ä¸€æ ·ç¬”è®°æœ¬ï¼Œå¯ä»¥é¿å…è¿‡äº†ä¸€æ®µæ—¶é—´æœ›ç€ä¸€å †çº¸å¤´ç—›ï¼Œç°åœ¨æ¡Œé¢åŸºæœ¬å¯ä»¥ä¸ç”¨æ”¾a4çº¸äº†ã€‚</p><p>ä¹Ÿè®¸å› ä¸ºconnectæ˜¯ä»–ä»¬åé¢åŠ çš„åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨21å¹´10æœˆä¹‹å‰ä¹°çš„å¯ä»¥è·å¾—æ— é™çš„free connectæƒé™ã€‚ä½†æ˜¯ä»–è®¤è¯è´­ä¹°ä¿¡æ¯çš„æ–¹å¼éå¸¸åŸå§‹ï¼Œæ˜¯è®©ä½ æä¾›è®¢å•é‚®ä»¶çš„è®¢å•å·ä»–ä»¬æ¥äººå·¥ç¡®è®¤ï¼Œäºæ˜¯æ‰¾å½“æ—¶è´­ä¹°çš„åº—å®¶è¦äº†ä¸ªè€è®¢å•é€šè¿‡äº†éªŒè¯ï¼ˆåº—å®¶ç›´æ¥ç»™äº†æˆ‘ä¸€ä¸ªä¸¤å¹´å‰çš„è®¢å•ï¼Œé‚®ä»¶ä¸Šé¢å†™çš„æ˜¯ç¬¬å››æ‰¹è´§â€¦â€¦ï¼‰ã€‚è€Œconnectè§£é”çš„åŠŸèƒ½æˆ‘è§‰å¾—æ¯”è¾ƒæœ‰ç”¨çš„å°±å‡ ä¸ªï¼šæ–‡ä»¶åŒæ­¥ã€é‚®ä»¶å‘é€ä»¥åŠä¸‰æ–¹å­˜å‚¨é›†æˆã€‚å¦‚æœæ²¡æœ‰connectè®¢é˜…çš„è¯è¶…è¿‡äº”åå¤©æ²¡æœ‰æ‰“å¼€çš„æ–‡ä»¶å°±æ°¸è¿œä¸ä¼šåŒæ­¥ï¼Œè¿™æ˜¾ç„¶æ˜¯æœ‰äº›å½±å“ä½¿ç”¨äº†;è€Œé‚®ä»¶å‘é€å’Œä¸‰æ–¹å­˜å‚¨éƒ½èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å¯¼å…¥å¯¼å‡ºé˜…è¯»ææ–™å’Œæ¶‚é¸¦ã€‚ä¸è¿‡å¦‚æœå®Œå…¨æ²¡æœ‰connectçš„è¯ä¹Ÿèƒ½é€šè¿‡usbå’Œç”µè„‘è¿æ¥æ¥æœ‰çº¿ä¼ è¾“ï¼Œæ‰€ä»¥å¤‡ä»½èµ·æ¥ä¹Ÿè¿˜è¡Œã€‚</p><h1 id="reHackable"><a href="#reHackable" class="headerlink" title="reHackable"></a>reHackable</h1><p>reMarkableçš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªå«åš<code>Codex</code>çš„linuxç³»ç»Ÿï¼Œé€šè¿‡usbè¿æ¥ä¸Šå°±ä¼šå¼€æ”¾ä¸€ä¸ªremote terminalç»™ä½ ï¼Œå¯èƒ½æ˜¯æ¯”è¾ƒå¼€æ”¾æ‰€ä»¥æœ‰è®¸å¤šä¸‰æ–¹åˆ›ä½œçš„å„ç§å·¥å…·æ¥å¢å¼ºä½¿ç”¨ä½“éªŒï¼Œ<a target="_blank" rel="noopener" href="https://github.com/reHackable/awesome-reMarkable">Awesome reMarkable</a>æ˜¯ä¸€ä¸ªawesomeåˆ—è¡¨ï¼Œå¯ä»¥æ‰¾åˆ°è®¸å¤šæœ‰è¶£çš„ä¸œè¥¿ã€‚æ¯”å¦‚æ‹¿æ¥æ‹‰å°æ¸…å•çš„<a target="_blank" rel="noopener" href="https://recalendar.me/">recalender</a>ï¼Œä»¥åŠçœ‹èµ·æ¥å¯ä»¥å®Œå…¨è‡ªå»ºconnectæœåŠ¡çš„<a target="_blank" rel="noopener" href="https://github.com/ddvk/rmfakecloud">rmfakecloud</a>ï¼Œç”šè‡³è¿˜æœ‰ä¸€ä¸ªåŒ…ç®¡ç†å™¨<a target="_blank" rel="noopener" href="https://toltec-dev.org/">Toltec</a>ã€‚æ´»è·ƒçš„hackå¸¦æ¥äº†è·Ÿå®˜æ–¹å…‹æ‰£featureå®Œå…¨ä¸ä¸€æ ·çš„ä½“éªŒï¼Œè™½ç„¶æ²¡æœ‰å®é™…ç”¨ä¸Šå‡ ä¸ªä½†æ˜¯çœ‹ç€å¾ˆèˆ’æœâ€¦â€¦</p><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>æœ€åè¿˜æ˜¯æƒ³å¼ºè°ƒä¸€ä¸‹çœ‹PDFçš„éœ€æ±‚ä½“éªŒæœ€å¥½ä¹Ÿæœ€ä¾¿å®œçš„æ–¹æ¡ˆè¿˜æ˜¯æ‰“å°å‡ºæ¥ã€‚<del>å”¯ä¸€åªæœ‰ç”µå­é˜…è¯»å™¨èƒ½å¤Ÿå¸¦æ¥çš„æ˜¯å’Œé˜…è¯»æ— å…³çš„èŠ±é’±çš„å¿«æ„Ÿ</del></p><p>æœ€è¿‘ä¹Ÿåœ¨å•†åœºé—²é€›çš„æ—¶å€™ä½“éªŒäº†ä¸€äº›å…¶ä»–å“ç‰Œçš„å¢¨æ°´å±ï¼Œæ„Ÿè§‰reMarkableçš„ä»·æ ¼è¿˜æ˜¯å¤ªæ²¡ä¼˜åŠ¿äº†ã€‚ç”¨å·®ä¸å¤šä¸€åŠçš„é’±å°±èƒ½ä¹°åˆ°å·®ä¸å¤šçš„ä¹¦å†™ä½“éªŒä»¥åŠä¹Ÿè®¸ä¼šæ˜¯åŠ åˆ†é¡¹çš„ç½‘ç»œå’ŒåŒæ­¥ä½“éªŒï¼Œå¦‚æœå†è®©æˆ‘é€‰ä¸€æ¬¡å¯èƒ½è¿˜æ˜¯ä¼šé‡æ–°çº ç»“ä¸€ä¸‹çš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;em&gt;é¢˜å›¾æ¥è‡ª&lt;a href=&quot;remarkable.com&quot;&gt;remarkable.com&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;h1 id=&quot;åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾&quot;&gt;&lt;a href=&quot;#åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾&quot; class=&quot;headerlink&quot; title=&quot;åˆä¸€æ¬¡å¹¿å‘ŠæŠ•æ”¾&quot;&gt;&lt;/a&gt;åˆ</summary>
      
    
    
    
    
    <category term="Experience" scheme="https://waynexia.github.io/tags/Experience/"/>
    
    <category term="Device" scheme="https://waynexia.github.io/tags/Device/"/>
    
  </entry>
  
  <entry>
    <title>æ·±æµ·è¿·èˆªï¼šå†°ç‚¹ä¹‹ä¸‹</title>
    <link href="https://waynexia.github.io/2022/03/subnautica-below-zero/"/>
    <id>https://waynexia.github.io/2022/03/subnautica-below-zero/</id>
    <published>2022-03-11T17:31:45.000Z</published>
    <updated>2023-01-02T06:28:43.268Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯ç³»åˆ—ç¬¬äºŒä½œã€‚ä½†æ˜¯ä»ä¸€äº›ä¹‹å‰çš„èµ„æ–™æ¥çœ‹ä¸€å¼€å§‹å†°ç‚¹ä¹‹ä¸‹æ˜¯ä½œä¸ºç¬¬ä¸€éƒ¨çš„ DLC çš„èº«ä»½é¢ä¸–çš„ï¼Œä¸è¿‡æˆ‘åœ¨ xbox å•†åº—çœ‹åˆ°çš„æ—¶å€™å®ƒå·²ç»å’Œã€Šæ·±æµ·è¿·èˆªã€‹åˆ†å¼€æˆä¸¤ä¸ªæ¡ç›®äº†ï¼Œä¹Ÿè®¸æ˜¯åšç€åšç€å°±æ‹¿å‡ºæ¥å•ç‹¬å”®å–äº†å§ã€‚ä¸è¿‡å¯èƒ½æ˜¯è¿™ä¸ªåŸå› ï¼Œå†°ç‚¹ä¹‹ä¸‹å¤§éƒ¨åˆ†çš„å…ƒç´ åŸºæœ¬å’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·ï¼Œç”»é¢å’Œæ“ä½œéƒ½æ˜¯ç†Ÿæ‚‰çš„å‘³é“<del>ï¼ˆæ²¡æœ‰è¯´å·æ‡’çš„æ„æ€ï¼‰</del>ã€‚</p><p>è¿™ä¸ªç³»åˆ—ç®€å•æ¥åº”è¯¥ç®—ä»¥æ¢ç´¢æµ·æ´‹ä¸ºä¸»é¢˜çš„ç”Ÿå­˜æ¸¸æˆã€‚ä¸¤æ¬¡éƒ½æ˜¯åœ¨ä¸€ç‰‡è¢«æµ·æ´‹è¦†ç›–çš„æ˜Ÿçƒä¸Šï¼ˆèƒŒæ™¯é‡Œé¢å¥½åƒæ˜¯åŒä¸€é¢—æ˜Ÿçƒï¼‰ï¼Œä»å è½æ—¶çš„ä¸€ä¸ªå°é€ƒç”Ÿèˆ±å¼€å§‹ï¼Œåœ¨æ¢ç´¢å‘¨å›´ç¯å¢ƒçš„è¿‡ç¨‹ä¸­è·å–ç”Ÿå­˜ç‰©èµ„ä¸è§£é”ç§‘æŠ€ï¼Œå¹¶é€šè¿‡ä¸æ–­åœ°æ‰©å¤§æ¢ç´¢èŒƒå›´æ¥æ¨è¿›å‰§æƒ…ã€‚è§‰å¾—è¿™ä¸ªç³»åˆ—æœ€æœ‰ç‰¹ç‚¹çš„åœ°æ–¹å°±æ˜¯å†æµ·æ´‹ä¸ºä¸»åœºæ™¯çš„è®¾å®šä¸‹å¸¦æ¥çš„ç«‹ä½“æ¢ç´¢çš„ä½“éªŒã€‚</p><p>è¿™ä¸€æ¬¡æ•…äº‹å‘ç”Ÿåœ¨å¦ä¸€å¼ åœ°å›¾ï¼Œä¸è¿‡å‰ä½œå…¶å®æ²¡æœ‰æ¨å®Œçš„æˆ‘å¹¶ä¸è®°å¾—å…·ä½“çš„åœ°å›¾æ˜¯ä»€ä¹ˆæ ·å­ï¼ŒçœŸæ­£è®©æˆ‘æ„Ÿåˆ°åœ°å›¾æ¢äº†çš„æ˜¯åœºæ™¯å…ƒç´ ã€‚å‰ä½œä»é€ƒç”Ÿèˆ±å‡ºæ¥ä¹‹ååœ¨å‘¨å›´è½¬æ‚ äº†å¾ˆä¹…æ‰è¿›è¡Œç¬¬ä¸€æ¬¡è¿œè¡Œï¼Œè¿˜è¢«è¾å°„è­¦å‘Šç»™å“äº†å›æ¥ã€‚ç„¶è€Œè¿™ä½œä¸ä»…æ²¡æœ‰è¾å°„è­¦å‘Šï¼Œç”šè‡³è¿˜èƒ½å¤Ÿå¾’æ‰‹å¼€é“€çŸ¿ã€‚ä¸è¿‡è¿™æ˜¯åé¢çš„å†…å®¹ï¼Œå†°ç‚¹ä¹‹ä¸‹ç¬¬ä¸€å¹•æ˜¯ä»å†°å·å¼€å§‹çš„ï¼Œåœ¨æˆ‘çš„å°è±¡ä¸­è¿™æ˜¯å‰ä½œæ²¡æœ‰çš„è¦ç´ ã€‚</p><img class="url&#x3D;map.png title&#x3D;æœ¬ä½œåœ°å›¾ï¼Œç™½è‰²æ˜¯æ–°å¢çš„é™†ä¸Šå†°å·éƒ¨åˆ†ï¼Œä¸è¿‡ä¸€å¤§åŠéƒ½æ˜¯å»ä¸äº†çš„ width&#x3D;30%"><p>ç¬¬ä¸€ä½œè¿›åº¦åº”è¯¥ä¸åˆ°ä¸‰åˆ†ä¹‹ä¸€ï¼Œç”šè‡³éƒ½æ²¡è§åˆ°åˆ©ç»´å¦ã€‚å½“æ—¶æ˜¯åœ¨å®¿èˆé‡Œé¢ï¼Œæ·±å¤œä¸¤ç‚¹ä¸­æˆ‘è¿˜åœ¨æ”¶é›†ç‰©èµ„ã€‚å±å¹•é‡Œå¤–éƒ½æ˜¯ä¸€ä¸ªäººï¼Œå†…å¿ƒä¸€ç›´æœ‰è¦ç»•ä¸æ•£ææƒ§æ„Ÿã€‚æˆ‘è®°å¾—é‚£æ—¶çš„æ—¥è®°å¥½åƒå†™äº†â€œè¿™ä¸ªæ¸¸æˆç©å‡ºäº†æ·±æµ·ææƒ§ç—‡â€ä¹‹ç±»çš„è¯ï¼Œå†ç©äº†å‡ ä¸ªå°æ—¶å°±é¡¶ä¸ä½å¼ƒäº†ã€‚è¿™ä¸ªç°è±¡åœ¨è¿™ä¸€æ¬¡è¿˜æ˜¯æ²¡æœ‰å¥½è½¬ï¼Œå½“è‡ªå·±åˆä¸€æ¬¡è¢«ä¸¢åˆ°æµ·é‡Œï¼Œå‘¨å›´åªæœ‰ä¸‰å››ç«‹æ–¹ç±³çš„å®‰å…¨ç©ºé—´æ—¶ï¼Œè¿™ç§ç†Ÿæ‚‰çš„æ„Ÿè§‰åˆå›æ¥äº†ã€‚ç”±äºåœ°å›¾åœºæ™¯éå¸¸å¤æ‚ï¼Œåœ¨å…¨èº«è´¯æ³¨åœ°è´´ç€æµ·åº•ç§»åŠ¨å¯»æ‰¾ç‰©èµ„çš„æ—¶å€™ç•™æ„æ°§æ°”è¡¨å°±å·²ç»å¾ˆç´§å¼ äº†ï¼Œç»å¸¸æ— æš‡ç•™æ„å‘¨å›´æ½œè—ç€çš„å…¶ä»–ç”Ÿç‰©ã€‚åœ¨å‰æœŸè¿˜æ²¡æœ‰è½½å…·è£…å¤‡èƒ½ç¨å¾®å¢åŠ ä¸€äº›å®‰å…¨æ„Ÿçš„æ—¶å€™å¥½å‡ æ¬¡è¢«çªå¦‚å…¶æ¥çš„è¢­å‡»å“åˆ°ã€‚è€Œå°±ç®—æœ‰äº†è½½å…·ä¹‹åé¢å¯¹æœªçŸ¥ç”Ÿç‰©æ—¶ä»ç„¶éš¾ä»¥å…‹æœææƒ§ï¼Œæ€»æ˜¯å°å¿ƒç¿¼ç¿¼åœ°é¿å…å’Œå®ƒä»¬æ¥è§¦ï¼Œæƒ³å»çš„åœ°æ–¹æœ‰å¥‡æ€ªç”Ÿç‰©åœ¨å¾˜å¾Šæ—¶ç»å¸¸ç­‰åˆ°è‚šå­é¥¿ã€‚è¿™æ—¶å€™æƒ³æƒ³ç¥–å…ˆèµ°å‡ºäº†ä¸›æ—çœŸæ˜¯å¤ªå¥½äº†ï¼Œèƒ½ç»å¸¸æŠŠåŸºæœ¬çš„ç”Ÿå­˜å½“ä½œä¸€ä»¶ç†æ‰€å½“ç„¶çš„äº‹æƒ…çœŸå®å¤ªå¥½äº†ã€‚</p><p>è€Œä¼´ç€è¿™ç§æ„Ÿè§‰åœ¨æµ·æ´‹ä¸­æ¸¸å¼‹çš„è¿‡ç¨‹ä¹Ÿè®¸æ˜¯æ¸¸æˆé‡Œæœ€è®©æˆ‘å–œæ¬¢çš„åœ°æ–¹ã€‚å’Œåœ¨æ¸¸æ³³é¦†æ¸¸æ³³ä¸åŒï¼Œæ¸¸æˆç”»é¢å¹¶æ²¡æœ‰æ¸²æŸ“å¯†é“ºçš„å°ç“·ç –æˆ–è€…è¢«æ³¢çº¹æ‰“æ•£åˆ°åœ°ä¸Šçš„å…‰çº¿ï¼Œè€Œæ˜¯é€šè¿‡ç«‹ä½“çš„ç”Ÿæ€ç¯å¢ƒæ¥ç»™äººåœ¨æ°´ä¸­çš„æ„Ÿè§‰ã€‚è€Œä¸”æ˜¯ä¸€ç‰‡éå¸¸å¹¿é˜”ï¼Œåœ°é¢å´å²–ï¼Œæ²¡æœ‰åŒç±»ä½†æœ‰è®¸å¤šå…¶ä»–ç‰©ç§çš„æ°´ã€‚</p><img class="url&#x3D;environment.png title&#x3D;å‰æœŸçš„è¿·è·¯ç‚¹"><p>ç„¶è€Œåœ¨å†™æœ¬ç¯‡çš„æ—¶å€™è§‰å¾—è¿™æ¬¡åˆè¦å¼ƒæ‰äº†ã€‚æ‰¾å®å†µå½•åƒå‚è€ƒäº†ä¸‹ï¼Œè¿™æ¬¡å‰§æƒ…åº”è¯¥æ˜¯åŸºæœ¬å¿«æ¨å®Œäº†ï¼Œä¸è¿‡è¿ç€æ¨äº†å‡ ä¸ªæ™šä¸Šè§‰å¾—è„‘è¢‹å·²ç»ä¸è¡Œäº†ã€‚åˆ°äº†åæœŸåŸºæœ¬ä¸Šæ‰€æœ‰åœ°æ–¹éƒ½èƒ½å¤Ÿå»ï¼Œæ‰¾ä¸œè¥¿ç¯èŠ‚å°±å˜å¾—éå¸¸éº»çƒ¦ã€‚æµ·æ´‹çš„éƒ¨åˆ†éšç€æ·±åº¦ä¸‹æ½œåœ°å½¢å˜å¾—è¶Šæ¥è¶Šç»•ï¼Œå°±ç®—ç»™äº†ä¿¡æ ‡ä¹Ÿè¦å»æ‰¾æ”»ç•¥æ‰çŸ¥é“æ€ä¹ˆèµ°ï¼Œè€Œé™†åœ°éƒ¨åˆ†ä¸€è¨€ä¸åˆå°±æ¥æç«¯å¤©æ°”æŠŠèƒ½è§åº¦é™åˆ°ä¼¸æ‰‹ä¸è§äº”æŒ‡ï¼Œè¿˜æœ‰é‡æ–°å›æ¥çš„å¼ºå¤§å¼•åŠ›ä¹Ÿç›´æ¥æŠŠæœºåŠ¨èƒ½åŠ›æ‘˜æ‰äº†ä¸€ä¸ªçºµè½´ã€‚è¿·è·¯è‡´æ­»çš„æ¬¡æ•°è¶Šæ¥è¶Šå¤šï¼Œä»¥è‡³äºç°åœ¨ä¸€å›æƒ³èµ·æ¥æ‰¾è·¯æ—¶åœ¨å¤©æ—‹åœ°è½¬çš„å±å¹•éƒ½ä¼šå¤´æ™•ã€‚å½“ç„¶è¿™ä¸ªè·¯ç—´å¯èƒ½æ˜¯æˆ‘çš„é—®é¢˜ï¼Œå°±ç®—æˆ‘åœ¨è¿™é‡ŒæŸ¥æ”»ç•¥çœ‹è·¯çº¿çš„æ¬¡æ•°å·²ç»æ¯” XB2 è¿˜å¤šäº†ï¼ˆ</p><p>è¿™ä¸€æ¬¡å¤§å‹æ€ªç‰©çš„æ‰ san ç¨‹åº¦å·²ç»æ¯”å‰ä½œå¥½äº†å¾ˆå¤šï¼Œä¸è¿‡è¿˜æ˜¯ä¸å¤ªèƒ½é€‚åº”ã€‚å¯¹æˆ‘æ¥è¯´æµ·æ´‹ä¸»é¢˜çš„å†’é™©å¤§æ¦‚è¦ ABZU é‚£ç§ç¨‹åº¦çš„æ‰ä¼šè§‰å¾—èˆ’æœå§ã€‚</p><img class="url&#x3D;fish.png title&#x3D;å·²ç»å’Œè”¼å¤šäº†çš„ç”Ÿç‰© width&#x3D;50%"><p>å¯¹äºæ–°åŠ çš„å†°åŸåœºæ™¯å¹¶ä¸æ˜¯å¾ˆå–œæ¬¢ï¼Œä¸¢æ‰äº†ç«‹ä½“æ¢ç´¢çš„ç‰¹è‰²ï¼Œå’Œå…¶ä»–çš„ä½œå“æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«äº†ï¼Œè€Œä¸”å°±ç®—æ˜¯åœ¨åŒä¸€ä¸ªä½œå“é‡Œé¢ä¹Ÿè§‰å¾—å†°åŸçš„ç”Ÿç‰©ä¸å¦‚æµ·æ´‹æœ‰æ„æ€ï¼ˆå¯èƒ½å„ç§å¥‡å¥‡æ€ªæ€ªçš„é™†åœ°ç”Ÿç‰©å¹³æ—¶çœ‹å¾—ä¹Ÿä¸å°‘äº†ï¼‰ã€‚è¿˜æœ‰é™†åœ°ä¸Šçš„è½½å…·çœŸæ˜¯å¤ªå‚¬åäº†ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯æ‰“å¼€æ–¹å¼æœ‰é—®é¢˜ï¼Œæ€»ä¹‹é€ å‡ºæ¥ä¹‹åå°±æ²¡ç¢°è¿‡å‡ å›ï¼Œå®æ„¿èµ°è·¯éƒ½ä¸æƒ³å¼€ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰äº›å…¶ä»–å½±å“ä½“éªŒçš„ç»†èŠ‚ï¼Œæ„Ÿè§‰å’Œå…¶ä»–å‡ ä¸ªæ¥è§¦äº†ä¸€æ®µæ—¶é—´çš„ä»¥ steam alpha æ¨¡å¼å¼€å‘çš„ä½œå“ç±»ä¼¼ï¼Œå‚å®¶<del>å°ä½œåŠ</del>åšäº†æ–°å¥‡çš„æ ¸å¿ƒç©æ³•ï¼Œä½†æ˜¯ä¸çŸ¥é“å¦‚ä½•æ›´è¿›ä¸€æ­¥åœ°å®Œå–„å¹¶ç»§ç»­æŒ–æ˜ä¸°å¯Œçš„å†…å®¹ã€‚æœ€åç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯å¼€å§‹å¾ˆæ–°å¥‡å¾ˆä¸Šå¤´ï¼Œä½†æ˜¯ç©ç€å®Œç€å°±æ€»æ˜¯æ„Ÿè§‰å·®äº†äº›ä¸œè¥¿ã€‚</p><p>æœ€åæ€»ç»“çš„è¯å°±æ˜¯<del>æŠ›æ‰ä¸å¥½çš„ä½“éªŒæ¥è¯´ä½“éªŒè¿˜æ˜¯å¯ä»¥çš„</del>ç•™ä¸€ä¸ªåœ¨æµ·ä¸­å†’é™©çš„æ¨¡ç³Šå°è±¡æ˜¯ä¸é”™çš„ï¼Œä½†æ˜¯ä¸å¤ªå¥½çš„æ¸¸ç©ä½“éªŒè®©æˆ‘ä¸å¤ªæƒ³ç»§ç»­æ“ä½œä¸‹å»å®Œæˆåé¢çš„å‰§æƒ…ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™æ˜¯ç³»åˆ—ç¬¬äºŒä½œã€‚ä½†æ˜¯ä»ä¸€äº›ä¹‹å‰çš„èµ„æ–™æ¥çœ‹ä¸€å¼€å§‹å†°ç‚¹ä¹‹ä¸‹æ˜¯ä½œä¸ºç¬¬ä¸€éƒ¨çš„ DLC çš„èº«ä»½é¢ä¸–çš„ï¼Œä¸è¿‡æˆ‘åœ¨ xbox å•†åº—çœ‹åˆ°çš„æ—¶å€™å®ƒå·²ç»å’Œã€Šæ·±æµ·è¿·èˆªã€‹åˆ†å¼€æˆä¸¤ä¸ªæ¡ç›®äº†ï¼Œä¹Ÿè®¸æ˜¯åšç€åšç€å°±æ‹¿å‡ºæ¥å•ç‹¬å”®å–äº†å§ã€‚ä¸è¿‡å¯èƒ½æ˜¯è¿™ä¸ªåŸå› ï¼Œå†°ç‚¹ä¹‹ä¸‹å¤§éƒ¨åˆ†çš„å…ƒç´ åŸºæœ¬å’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·ï¼Œç”»é¢å’Œæ“ä½œéƒ½æ˜¯</summary>
      
    
    
    
    
    <category term="Experience" scheme="https://waynexia.github.io/tags/Experience/"/>
    
    <category term="Game" scheme="https://waynexia.github.io/tags/Game/"/>
    
  </entry>
  
  <entry>
    <title>Paper Reading: Adaptive Radix Tree</title>
    <link href="https://waynexia.github.io/2020/07/adaptive-radix-tree/"/>
    <id>https://waynexia.github.io/2020/07/adaptive-radix-tree/</id>
    <published>2020-07-13T21:45:12.000Z</published>
    <updated>2023-01-02T06:28:43.260Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯-ART"><a href="#ä»€ä¹ˆæ˜¯-ART" class="headerlink" title="ä»€ä¹ˆæ˜¯ ART ?"></a>ä»€ä¹ˆæ˜¯ ART ?</h1><p>ART æ˜¯ä¸€ä¸ªèƒ½æä¾›é«˜æ•ˆç‚¹çš„å¢åˆ æŸ¥æ”¹ï¼Œä»¥åŠèŒƒå›´æŸ¥è¯¢çš„ç´¢å¼•ç»“æ„ã€‚æ˜¯ä¸€ä¸ªæœ‰åºçš„æ˜ å°„ã€‚åç§°ä¸­çš„ radix è¡¨ç¤ºè¿™æ˜¯ä¸€é¢—ç”¨åŸºæ•°æ¥æ„å»ºçš„ç»“æ„ï¼Œå†…éƒ¨æ•°æ®æ˜¯æœ‰åºå­˜å‚¨çš„ï¼Œæ‰€ä»¥æœ‰é«˜æ•ˆèŒƒå›´æŸ¥è¯¢çš„èƒ½åŠ›ã€‚ç›¸æ¯”äºå…¶ä»–å¸¸è§çš„åŸºæ•°ç»“æ„ï¼ŒART çš„ç©ºé—´åˆ©ç”¨ç‡æ›´é«˜ã€‚è¿™å¾—ç›Šäºå®ƒ adaptive çš„ç‰¹æ€§ï¼Œå³èƒ½å¤Ÿæ ¹æ®ç©ºé—´ä½¿ç”¨æƒ…å†µåŠ¨æ€åœ°è°ƒèŠ‚èŠ‚ç‚¹å¤§å°ã€‚</p><img class="url&#x3D;.&#x2F;1.png title&#x3D;Compare to HashTable"><h1 id="åŸºæ•°æ ‘"><a href="#åŸºæ•°æ ‘" class="headerlink" title="åŸºæ•°æ ‘"></a>åŸºæ•°æ ‘</h1><p>æ˜¯trieæ ‘çš„ä¸€ç§ã€‚è¿™ç§æ•°æ®ç»“æ„æ‰€å‚¨å­˜çš„ä¿¡æ¯å¹¶ä¸åœ¨æŸä¸ªèŠ‚ç‚¹ä¸Šï¼Œè€Œæ˜¯ç”±ä¸€æ¡ç”±æ ¹åˆ°å¶èŠ‚ç‚¹çš„è·¯å¾„æ‰€è¡¨ç¤ºï¼ˆå½“ç”¨ä½œæ˜ å°„çš„æ—¶å€™é€šå¸¸ä¸ºé”®çš„ä¿¡æ¯å‚¨å­˜åœ¨è·¯å¾„ä¸Šï¼Œå€¼çš„ä¿¡æ¯å­˜äºå¯¹åº”çš„å¶èŠ‚ç‚¹ï¼‰ã€‚</p><img class="url&#x3D;2.png title&#x3D;An ART"><h1 id="Adaptive-Node"><a href="#Adaptive-Node" class="headerlink" title="Adaptive Node"></a>Adaptive Node</h1><p>ART ä½¿ç”¨èƒ½åŠ¨æ€è°ƒèŠ‚å¤§å°ï¼ˆè‡ªé€‚åº” adaptiveï¼‰çš„èŠ‚ç‚¹ä½œä¸ºå†…éƒ¨æ ‘èŠ‚ç‚¹ï¼Œèƒ½å¤Ÿæé«˜å†…å­˜ä½¿ç”¨ç‡ã€‚DBMS ä¸­å¸¸è§çš„æœ‰åºç´¢å¼•æ•°æ®ç»“æ„B-treeæˆ–è€…ä¼ ç»Ÿçš„radix treeå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œå› æ­¤å­˜åœ¨ç©ºé—´æ”¾å¤§çš„é—®é¢˜ã€‚ç±»ä¼¼äºç£ç›˜æˆ–å†…å­˜é¡µè¡¨çš„å¤§å°ï¼ŒèŠ‚ç‚¹çš„å¤§å°é€šå¸¸éœ€è¦å–èˆï¼ŒèŠ‚ç‚¹å¤ªå¤§çš„è¯æµªè´¹å¾ˆä¸¥é‡ï¼ŒèŠ‚ç‚¹å¤ªå°è·¯å¾„åˆå¾ˆé•¿ï¼Œå½±å“è¯»å†™æ•ˆç‡ã€‚</p><img class="url&#x3D;3.png"><p>è™½ç„¶ç†è®ºä¸Šè¯´èƒ½å¤Ÿä½¿ç”¨åŠ¨æ€æ•°ç»„ä½œä¸ºå†…éƒ¨èŠ‚ç‚¹ï¼Œä½†æ˜¯è¿™æ ·ä¼šæ¶‰åŠåˆ°é¢‘ç¹çš„å†…å­˜åˆ†é…é‡Šæ”¾ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒARTå°†èŠ‚ç‚¹çš„å¤§å°å›ºå®šä¸ºäº†å››ç§ã€‚åˆ†åˆ«ä¸º4ã€16ã€48ä»¥åŠ256ã€‚å¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹æ ¹æ®å¤§å°ï¼Œåœ¨å…·ä½“çš„ç»“æ„ä»¥åŠè¡Œä¸ºä¸Šä¼šæœ‰ç»†å¾®ä¸åŒ</p><h1 id="å››ç§èŠ‚ç‚¹çš„å…·ä½“å®ç°"><a href="#å››ç§èŠ‚ç‚¹çš„å…·ä½“å®ç°" class="headerlink" title="å››ç§èŠ‚ç‚¹çš„å…·ä½“å®ç°"></a>å››ç§èŠ‚ç‚¹çš„å…·ä½“å®ç°</h1><p>é¦–å…ˆèŠ‚ç‚¹ç±»å‹çš„å˜åŒ–ä»…å‘ç”Ÿåœ¨ä¸Šæº¢æˆ–è€…ä¸‹æº¢æ—¶ï¼Œå³å¯ä»¥/éœ€è¦ä½¿ç”¨å¦ä¸€ç§ç±»å‹çš„èŠ‚ç‚¹æ¥ä»£æ›¿ã€‚éœ€è¦æ³¨æ„ç”±äºå‰ç¼€æ ‘çš„ç‰¹æ€§ï¼Œä¸€ä¸ªèŠ‚ç‚¹çš„æœ€å¤§å®½åº¦æ˜¯æœ‰é™çš„ï¼Œå› æ­¤å¹¶ä¸ä¼šæ¨ªå‘åˆ†è£‚æˆä¸¤ä¸ªèŠ‚ç‚¹ã€‚</p><h2 id="Node4-ä¸-Node16"><a href="#Node4-ä¸-Node16" class="headerlink" title="Node4 ä¸ Node16"></a>Node4 ä¸ Node16</h2><img class="url&#x3D;4.png title&#x3D;Node4 and Node16"><p>Node4 ä¸ Node16 åœ¨ç»“æ„ä¸Šé¢æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯ç”±ä¸€å¯¹æ•°é‡ç›¸ç­‰çš„æ•°ç»„ç»„æˆï¼Œå…¶ä¸­ä¸€ä¸ªå­˜æ”¾é”®ï¼Œå¦ä¸€ä¸ªå­˜æ”¾æŒ‡é’ˆã€‚</p><h2 id="Node48"><a href="#Node48" class="headerlink" title="Node48"></a>Node48</h2><img class="url&#x3D;5.png title&#x3D;Node48"><p>Node48 ä¸å‰ä¸¤ç§ä¸€æ ·ä¹Ÿæ˜¯ç”±ä¸¤ä¸ªæ•°ç»„ç»„æˆï¼Œä¸è¿‡å­˜å‚¨é”®çš„æ•°ç»„æœ‰256çš„å®¹é‡ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ä¸‹æ ‡è¿›è¡Œç´¢å¼•ã€‚</p><h2 id="Node256"><a href="#Node256" class="headerlink" title="Node256"></a>Node256</h2><img class="url&#x3D;6.png title&#x3D;Node256"><p>Node256ä¸Node48ç›¸æ¯”å…¶å®å°±æ˜¯ç¬¬äºŒä¸ªæ•°ç»„çš„å¤§å°ä¹Ÿæ¥åˆ°äº†256ï¼Œé”®ä¸å€¼æœ‰æ»¡å°„çš„å…³ç³»ï¼Œå¯ä»¥çœç•¥ä¸€æ¬¡ç´¢å¼•ã€‚</p><h1 id="è·¯å¾„å‹ç¼©"><a href="#è·¯å¾„å‹ç¼©" class="headerlink" title="è·¯å¾„å‹ç¼©"></a>è·¯å¾„å‹ç¼©</h1><p>æ–‡ä¸­å°†è·¯å¾„å‹ç¼©åˆ†æˆäº†ä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ path compression å’Œ lazy expansionã€‚ path compression æŒ‡å°†åªæœ‰ä¸€ä¸ª key çš„èŠ‚ç‚¹å¾€ä¸‹åˆå¹¶ï¼Œç›´åˆ°éœ€è¦åŒºåˆ†å¤šä¸ªå­èŠ‚ç‚¹ä¸ºæ­¢ã€‚lazy expansion è¡¨ç¤ºæŠŠä¸€ä¸ªèŠ‚ç‚¹è·¯å¾„ä¸Šæ²¡æœ‰åˆ†å‰çš„éƒ¨åˆ†æŠ˜å èµ·æ¥ã€‚</p><img class="url&#x3D;7.png title&#x3D;Two ways of path compression"><p>æ—¢ç„¶è·¯å¾„è¢«å‹ç¼©ï¼Œé‚£ä¹ˆåœ¨æŸ¥æ‰¾çš„æ—¶å€™ä¹Ÿéœ€è¦åœ¨æ¯”è¾ƒ key æ—¶è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚æ–‡ä¸­å°†å¤„ç†åˆ†ä¸ºäº†ä¸¤ç±»ã€‚æ‚²è§‚çš„æ–¹å¼æ˜¯èŠ‚ç‚¹å‚¨å­˜ä¸€ä¸ªé•¿åº¦ä¸å®šçš„å‰ç¼€å€¼ï¼Œåœ¨æ¯æ¬¡ä¸‹é™åœ°æ—¶å€™ä½¿ç”¨è¿™ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒã€‚ä¹è§‚åœ°æ–¹å¼æ˜¯èŠ‚ç‚¹åªå‚¨å­˜è¢«å‹ç¼©åœ°å‰ç¼€åœ°é•¿åº¦ï¼Œåœ¨æ¯æ¬¡ä¸‹é™è¿‡ç¨‹ä¸­ç›´æ¥è·³è¿‡è¿™ä¸ªé•¿åº¦çš„ key çš„å¤„ç†ï¼Œå¹¶åœ¨æœ€åè¾¾åˆ°å¶å­èŠ‚ç‚¹æ—¶å†æ¯”è¾ƒ key æ˜¯å¦ç›¸ç­‰ã€‚æ–‡ä¸­çš„èŠ‚ç‚¹å°†è¿™ä¸¤ç§æ–¹å¼ç»„åˆèµ·æ¥ï¼Œåœ¨ä¸‹é™çš„æ—¶å€™æŒ‰ç…§å‰ç¼€é•¿åº¦è¿›è¡ŒåŠ¨æ€å¤„ç†ã€‚</p><h1 id="èŠ‚ç‚¹-header"><a href="#èŠ‚ç‚¹-header" class="headerlink" title="èŠ‚ç‚¹ header"></a>èŠ‚ç‚¹ header</h1><p>ä¸€ä¸ªèŠ‚ç‚¹é™¤äº†è‡ªå·±çš„æ•°æ®åŸŸä¹‹å¤–ï¼Œè¿˜åŒ…å«äº†ä¸€äº›å…ƒä¿¡æ¯ã€‚ä¾‹å¦‚èŠ‚ç‚¹çš„ç±»å‹ï¼Œå®é™…å®¹é‡ï¼Œå‹ç¼©çš„è·¯å¾„ï¼ˆå‰ç¼€å’Œ / æˆ–å‰ç¼€çš„é•¿åº¦ï¼‰ç­‰ã€‚åœ¨æ–‡ä¸­ï¼ŒèŠ‚ç‚¹æœ‰å…«å­—èŠ‚çš„å‰ç¼€åŒºåŸŸä»¥åŠå››å­—èŠ‚çš„å‰ç¼€é•¿åº¦åŸŸï¼Œå³ä¸Šä¸€æ®µæåˆ°çš„æ‚²è§‚ä¸ä¹è§‚ç›¸ç»“åˆçš„å¤„ç†æ–¹æ³•ã€‚</p><h1 id="è¯»å†™æ“ä½œ"><a href="#è¯»å†™æ“ä½œ" class="headerlink" title="è¯»å†™æ“ä½œ"></a>è¯»å†™æ“ä½œ</h1><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>å¯¹äº Node4 é‡‡ç”¨éå†çš„æ–¹æ³•ï¼ŒNode16 ä½¿ç”¨ SIMD æˆ–è€…äºŒåˆ†æ¥æ¯”è¾ƒå½“å‰çš„ keyï¼ŒNode48 ä¸ Node256 åˆ†åˆ«åªéœ€è¿›è¡Œä¸¤æ¬¡ / ä¸€æ¬¡ç´¢å¼•å°±èƒ½å¯¹æ¯”åˆ°å‰ç¼€è¿›è¡Œä¸‹é™ã€‚<br>ä¸€ä¸ªä¸€èˆ¬çš„æŸ¥è¯¢æµç¨‹ä¸ºæ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹è¿›è¡Œä¸‹é™æˆ–è¿”å›å®ŒæˆæŸ¥æ‰¾ï¼Œå¯¹äºä¸å­˜åœ¨çš„é”®æˆ–è€…èŠ‚ç‚¹è¿”å›ç©ºã€‚å¦å¤–ç”±äº path compression çš„å­˜åœ¨ï¼Œå¯èƒ½ä¸€æ¬¡ä¸‹é™ä¼šå®Œæˆå¤šä¸ª bytes çš„æ¯”è¾ƒã€‚<br>è€Œ range scan å¯ä»¥ä½¿ç”¨ç±»ä¼¼æ·±æœçš„æ•°æ¬¡æŸ¥è¯¢å®ç°ã€‚</p><h2 id="æ’å…¥-åˆ é™¤"><a href="#æ’å…¥-åˆ é™¤" class="headerlink" title="æ’å…¥ / åˆ é™¤"></a>æ’å…¥ / åˆ é™¤</h2><p>ä¸€èˆ¬ä¸€ä¸ª key çš„æ’å…¥æˆ–åˆ é™¤å¯èƒ½å‡ºç°å‡ ç§ç‰¹æ®Šæƒ…å†µã€‚å‘ç”Ÿä¸Šæº¢/ä¸‹æº¢æ—¶éœ€è¦è¿›è¡ŒèŠ‚ç‚¹çš„æ›¿æ¢æ¥å®Œæˆæ‰©/ç¼©å®¹ï¼›å¦‚æœä¸€æ¬¡æ‰©ç¼©å®¹è§¦å‘äº†è·¯å¾„å‹ç¼©ï¼Œé‚£ä¹ˆä¼šæœ‰å†…éƒ¨èŠ‚ç‚¹çš„æ–°å¢æˆ–åˆ é™¤ï¼Œä»¥åŠèŠ‚ç‚¹å…ƒä¿¡æ¯é‡Œå‰ç¼€æ•°æ®çš„è°ƒæ•´ã€‚<br>å¦‚æœä¸€æ¬¡æ‰©å®¹çš„èŠ‚ç‚¹æ˜¯ lazy expansion çš„ï¼Œæˆ–è€…ç¼©å®¹å¯¼è‡´èŠ‚ç‚¹çš„å®é™…å®¹é‡å˜ä¸º1ï¼Œé‚£ä¹ˆè¿™æ¡è·¯å¾„çš„é•¿åº¦ä¼šå‘ç”Ÿå˜åŒ–ï¼ˆä»¥æ’å…¥ä¸ºä¾‹ï¼Œä½¿ç”¨ä¸€ä¸ªæ–°èŠ‚ç‚¹æ›¿æ¢å½“å‰çš„å¶å­èŠ‚ç‚¹ï¼Œè¿™ä¸ªæ–°èŠ‚ç‚¹æœ‰ä¸¤ä¸ªå¶å­èŠ‚ç‚¹ï¼Œåˆ†åˆ«ä¸ºä¹‹å‰çš„ä»¥åŠæ–°å¢çš„ï¼ŒèŠ‚ç‚¹çš„å‰ç¼€ä¹Ÿä¼šå˜æˆä¸¤ä¸ªå¶å­èŠ‚ç‚¹çš„ key çš„é‡åˆéƒ¨åˆ†ï¼‰ï¼›å¦‚æœæ–°æ’å…¥èŠ‚ç‚¹çš„ key ä¼šå½±å“ä¸€ä¸ªèŠ‚ç‚¹çš„å‰ç¼€ï¼Œé‚£ä¹ˆä¹Ÿä¼šåœ¨è¯¥èŠ‚ç‚¹ä¸Šé¢æ–°å¢ä¸€ä¸ª inner èŠ‚ç‚¹ï¼Œå¹¶ç›¸åº”åœ°è°ƒèŠ‚å‰ç¼€ï¼›å…¶ä»–çš„æƒ…å†µåªéœ€è¦è¿›è¡Œç®€å•çš„æ’å…¥åˆ é™¤å°±è¡Œäº†ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸Šè¿°å‡ ç§æƒ…å†µä¸­ï¼Œä¸€æ¬¡å¢åˆ è¿‡ç¨‹ä¸­ä¼šå—åˆ°å½±å“çš„èŠ‚ç‚¹æœ€å¤šä»…æœ‰ä¸¤ä¸ªã€‚</p><h1 id="æ•°æ®è¡¨ç¤º"><a href="#æ•°æ®è¡¨ç¤º" class="headerlink" title="æ•°æ®è¡¨ç¤º"></a>æ•°æ®è¡¨ç¤º</h1><p>ä¸ºäº†å®ç°æ•°æ®æœ‰åºæ’åˆ—ï¼Œéœ€è¦èƒ½å°†æ•°æ®ç±»å‹è¡¨ç¤ºæˆäºŒè¿›åˆ¶å¯æ¯”è¾ƒï¼ˆbinary comparableï¼‰çš„å½¢å¼ã€‚<br>æ— ç¬¦å·æ•´å‹å¤©ç„¶æ»¡è¶³è¦æ±‚ï¼Œåªæ˜¯éœ€è¦æ³¨æ„å¤§å°ç«¯ã€‚æœ‰ç¬¦å·æ•´å‹éœ€è¦åšä¸€æ¬¡å¼‚æˆ–æ“ä½œæ¥å¤„ç†è¡¥ç è¡¨ç¤ºæ³•ã€‚æµ®ç‚¹æ•°ç¨å¾®å¤æ‚ä¸€äº›ï¼ŒæŒ‰ç…§ [ æ­£ï¼Œè´Ÿ ] x [ è§„æ ¼åŒ–ã€éè§„æ ¼åŒ–ã€NaNã€âˆã€0 ] åˆ†ä¸ºäº’ä¸é‡å çš„åç±»ï¼Œç„¶åé‡æ–°ç»™ rankã€‚å¯¹äºå­—ç¬¦ä¸²æœ‰ Unicode å®šä¹‰çš„æ¯”è¾ƒç®—æ³•ã€‚</p><h1 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h1><p>åœ¨æœ¬æ–‡çš„ benchmark ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå½“æ•°æ®çš„ key åˆ†å¸ƒæ¯”è¾ƒå¯†é›†æ—¶ï¼ŒART æœ‰ç€å¾ˆä¼˜ç§€çš„è¡¨ç°ã€‚è€Œä¸”é™¤äº† range scan èŒƒå›´è¯»ä¹‹å¤–ï¼ŒART çš„ bulk load èŒƒå›´å†™ä¹Ÿæœ‰å¾ˆå¤§çš„å‘æ˜ç©ºé—´ã€‚</p><h1 id="å¹¶å‘"><a href="#å¹¶å‘" class="headerlink" title="å¹¶å‘"></a>å¹¶å‘</h1><p>æ–‡ç« ä»‹ç»äº†ä¸¤ç§å¹¶å‘æ–¹æ¡ˆï¼Œåˆ†åˆ«æ˜¯ Optimistic Lock Coupling å’Œ Read-Optimized Write EXclusion (ROWEX)ã€‚å®ƒä»¬çš„æ€§èƒ½å¾ˆæ¥è¿‘ã€‚</p><img class="url&#x3D;8.png title&#x3D;Comparison of serval concurrency schemas"><h2 id="Optimistic-Lock-Coupling"><a href="#Optimistic-Lock-Coupling" class="headerlink" title="Optimistic Lock Coupling"></a>Optimistic Lock Coupling</h2><p>æ˜¯åœ¨ä¼ ç»Ÿ Lock Coupling æ–¹æ¡ˆä¸Šçš„ä¸€ç§ä¼˜åŒ–ã€‚Lock Coupling çš„é‡ç‚¹åœ¨äºä¸€ä¸ªæ“ä½œåŒæ—¶æœ€å¤šæŒæœ‰ä¸¤æŠŠé”ï¼Œæ˜¯çº¿ç¨‹åŒæ­¥ B-Tree çš„å¸¸è§åšæ³•ã€‚å¹¶ä¸”åœ¨ ART çš„èƒŒæ™¯ä¸‹ï¼Œä¸€æ¬¡ä¿®æ”¹æœ€å¤šåªä¼šå½±å“åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œéå¸¸é€‚åˆä½¿ç”¨ Lock Coupling æ¥å®ç°å¹¶å‘ã€‚ä½†æ˜¯ Lock Coupling å› ä¸ºæ¯æ¬¡å–å¾—ä¸€æŠŠé”éƒ½ä¼šä¿®æ”¹èŠ‚ç‚¹çš„å†…å®¹ï¼Œæ‰€ä»¥å¯¹ç¼“å­˜å¾ˆä¸å‹å¥½ï¼Œå¯¼è‡´å…¶æ•ˆç‡ä½ä¸‹ã€‚åœ¨è¿™é‡Œé‡‡ç”¨ä¸€ç§ Optimistic çš„åšæ³•ï¼Œå³å‡è®¾å†²çªå¾ˆå°‘å‡ºç°ï¼Œæ¯æ¬¡åªåœ¨è¯»å®Œä¹‹åæ£€æµ‹ç‰ˆæœ¬ä¿¡æ¯æ¥åˆ¤æ–­æœ‰æ²¡æœ‰è¯»åˆ°è¿‡æ—¶ä¿¡æ¯ï¼Œè€Œéé¢„å…ˆä¸Šé”æ¥ç¡®ä¿äº’æ–¥ã€‚å¦‚æœæ£€æµ‹åˆ°äº†è¿‡æœŸä¿¡æ¯åˆ™è¿›è¡Œé‡è¯•ï¼Œä¸ºäº†é˜²æ­¢é¥¿æ­»å¯ä»¥åœ¨è‹¥å¹²æ¬¡é‡è¯•å¤±è´¥ä¹‹åè¿›è¡ŒåŠ é”ã€‚</p><h2 id="ROWEX"><a href="#ROWEX" class="headerlink" title="ROWEX"></a>ROWEX</h2><p>åˆ™ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå®ƒè¦æ±‚ writer é€šè¿‡åŸå­æ“ä½œæ¥ä¿è¯ reader ä¸ä¼šå‡ºç°è„è¯»ã€‚è¿™ä¸ªæ–¹æ³•ä¹Ÿä½¿ç”¨åˆ°äº†é”ï¼Œä¸è¿‡ä»…é’ˆå¯¹ writer æä¾›äº’æ–¥æ€§ï¼Œè€Œè¯»æ“ä½œæ˜¯ wait-free å¹¶ä¸”ä¸ Optimistic Lock Coupling ä¸åŒï¼Œæ˜¯ä¿è¯æˆåŠŸçš„ã€‚</p><h1 id="Bench"><a href="#Bench" class="headerlink" title="Bench"></a>Bench</h1><p><a target="_blank" rel="noopener" href="https://dbis-informatik.uibk.ac.at/sites/default/files/2018-06/hot-height-optimized.pdf">HOT (SIGMOD 2018)</a> appendix A æœ‰æ¯”è¾ƒå…¨é¢çš„ Cross Validationã€‚TL; DR. åœ¨æ•°æ®å¯†é›†æŸ¥è¯¢æ¯”æ‰«æå¤šï¼Œå†™æ“ä½œæ¯”é‡è¾ƒå¤šçš„æƒ…å†µä¸‹ ART æœ‰å¾ˆä¼˜ç§€çš„è¡¨ç°ï¼Œçº¯æ‰«è¡¨æ€§èƒ½å¹¶ä¸æ¯” B-Tree å¥½ã€‚å¤§é‡å¯†é›†æ•°æ®ç‚¹æŸ¥è¡¨ç°å¯ä»¥è¶…è¿‡ HashTableï¼Œä¸è¿‡æ€§èƒ½ä¼šå—åˆ°æ•°æ®åˆ†å¸ƒçš„å½±å“ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä»€ä¹ˆæ˜¯-ART&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯-ART&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯ ART ?&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯ ART ?&lt;/h1&gt;&lt;p&gt;ART æ˜¯ä¸€ä¸ªèƒ½æä¾›é«˜æ•ˆç‚¹çš„å¢åˆ æŸ¥æ”¹ï¼Œä»¥åŠèŒƒå›´æŸ¥è¯¢çš„ç´¢å¼•ç»“æ„ã€‚æ˜¯ä¸€ä¸ªæœ‰åºçš„æ˜ å°„ã€‚åç§°ä¸­çš„ r</summary>
      
    
    
    
    
    <category term="Paper Reading" scheme="https://waynexia.github.io/tags/Paper-Reading/"/>
    
  </entry>
  
</feed>
