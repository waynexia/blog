<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 6.0.0">

  
    <meta name="description" content="Wayne&#39;s personal blog">
  

  

  
    <meta name="author" content="Wayne">
  

  

  

  <title>How error occurs in GreptimeDB | Wonderland</title>

  
    <link rel="alternate" href="/atom.xml" title="Wonderland" type="application/atom+xml">
  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://raw.githubusercontent.com/waynexia/flexblock-modified/main/source/89433360_p0.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          Wonderland
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">Home</a></li>
        
          <li class="navbar-list-item"><a href="/about">About</a></li>
        

        <li class="navbar-list-item">|</li>

        <li class="navbar-list-item"><a href="javascript:;" id="theme-light">üåû Light</a></li>
        <li class="navbar-list-item"><a href="javascript:;" id="theme-dark">üåõ Dark</a></li>
        <li class="navbar-list-item"><a href="javascript:;" id="theme-auto">üåó Auto</a></li>
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">How error occurs in GreptimeDB</h1>
          <h2 class="title-sub-wrap">
            <strong>Wayne</strong>
            <span>write on</span>
            <time  class="article-date" datetime="2024-01-22T00:53:48.000Z" itemprop="datePublished">2024-01-22</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
    <li><a href="/tags/Rust/">üè∑Ô∏è Rust</a></li>
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- ÊñáÁ´† -->

<!-- ÊñáÁ´†ÂÜÖÂÆπ -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <link rel="stylesheet" href="//unpkg.com/heti/umd/heti.min.css">
      <script src="//unpkg.com/heti/umd/heti-addon.min.js"></script>
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <article class="heti heti--sans">
          <style>
            .heti {
              max-width: 100%;
              line-height: 1.5em;
            }
            figure.highlight { text-align: left; }
            .heti figure table { border-width: 0px; }
            .heti blockquote {
              background-color: transparent;
              padding-block-start: 0px;
              padding-block-end: 0px;
            }
            .heti--vertical {
              overflow-x: scroll;
            }
            .heti-em {
              text-emphasis: filled circle;
              text-emphasis-position: under;
            }
            </style>
            <script>
              const heti = new Heti('.heti');
              heti.autoSpacing();
            </script>
          <blockquote>
<p>TL;DR:</p>
<p>This post discusses the practice of Rust error handling topic in GreptimeDB. Including how to build a cheaper yet more accurate error stack to replace system backtrace, how to organize errors in large project and how to print errors in different schemes to log and end users. And shares possibly future work in the end.</p>
<p>An example of error in GreptimeDB looks like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">0: Foo error, at src/common/catalog/src/error.rs:80:10<br>1: Bar error, at src/common/function/src/error.rs:90:10<br>2: Root cause, invalid table name, at src/common/catalog/src/error.rs:100:10<br></code></pre></td></tr></table></figure>
</blockquote>
<h1 id="Introduce"><a href="#Introduce" class="headerlink" title="Introduce"></a>Introduce</h1><h2 id="What-Error-is-in-Rust"><a href="#What-Error-is-in-Rust" class="headerlink" title="What Error is in Rust"></a>What <code>Error</code> is in Rust</h2><!-- toc:
- What `Error` is in Rust. -->

<p>In Rust, functions that might fail usually return a special enum <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/result/enum.Result.html#variant.Err"><code>Result&lt;T, E&gt;</code></a>, where <code>E</code> usually implements the trait <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/error/trait.Error.html"><code>std::error::Error</code></a>. This is the fundamental of error handling.</p>
<p>This blog shares our experience on how to organize variant types of <code>Error</code> in a relatively complex system like GreptimeDB, which is composed of multiple components with their own <code>Error</code> definition. From how an error is defined to how to present an error to log or end-user.</p>
<!-- todo: add a doc here? -->

<h2 id="Ecosystem-at-present"><a href="#Ecosystem-at-present" class="headerlink" title="Ecosystem at present"></a>Ecosystem at present</h2><!-- toc:
- Two widely used crates about error: `thiserror` and `anyhow`.
- How those two are used. Define customized error type.
- Introduce `snafu`, and its characteristics. -->

<p>There are some <code>Error</code> structs in std that implement <code>std::error::Error</code>, like <code>std::io::Error</code> or <code>std::fmt::Error</code>. But we would usually define one for our project, as either we want to express our own error info or we may face multiple errors at the same time.</p>
<p>Given the <code>std::error::Error</code> trait is not complicated, it‚Äôs easy to implement manually for the customized error type. However you usually won‚Äôt want to do so. When error variants increase, it might be hard to work with flooding template code. Nowadays, there are some widely used utility crates to help play around with customized error types, like <a target="_blank" rel="noopener" href="https://docs.rs/thiserror/latest/thiserror/"><code>thiserror</code></a> and <a target="_blank" rel="noopener" href="https://docs.rs/anyhow/latest/anyhow/"><code>anyhow</code></a>, from the same author. Said that, use <code>thiserror</code> for library project and <code>anyhow</code> for binary project. This rule suits a major number of cases.</p>
<p>But for projects like GreptimeDB, where we divide the entire workspace into several individual sub-crates, we need to define an error type for each crate while keeping a streamlined combination. Neither <code>thiserror</code> nor <code>anyhow</code> can achieve this easily.</p>
<p>Here we choose another crate <a target="_blank" rel="noopener" href="https://docs.rs/snafu/latest/snafu/"><code>snafu</code></a> to instrument our error system. It‚Äôs like a combination of <code>thiserror</code> and <code>anyhow</code>. <code>thiserror</code> provides a convenient macro to define customized error type, with display, source and some context fields. And <code>anyhow</code> gives a <code>Context</code> trait that can easily transform from one underlying error into another with a new context.</p>
<p><code>thiserror</code> mainly implements the <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/convert/trait.From.html"><code>std::convert::From</code></a> trait for your error type, so that you can easily use <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/convert/trait.From.html"><code>?</code></a> to propagate the error you receive. Consequently, this also means you cannot define two error variants that come from the same source. Considering you are performing some I/O operations, you won‚Äôt know whether an error is generated in write or read. This is also an important reason we don‚Äôt use <code>thiserror</code> ‚Äì the context is blurred in type.</p>
<h1 id="Stacking-Error"><a href="#Stacking-Error" class="headerlink" title="Stacking Error"></a>Stacking Error</h1><h2 id="What-we-want-from-error"><a href="#What-we-want-from-error" class="headerlink" title="What we want from error"></a>What we want from error</h2><!-- toc:
- In the real world, knowing what the error is is not enough. -->

<p>In the real world, only knowing what an error is is far not enough. Imagine we are building a little protocol component in GreptimeDB (or any other project, just for example), It reads messages from the Internet, decodes, performs some operations and then sends it. We may encounter errors from several aspects:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Error</span></span>&#123;<br>    ReadSocket(hyper::Error),<br>    DecodeMessage(serde_json::Error),<br>    Operation(GreptimeError),<br>    EncodeMessage(serde_json::Error),<br>    WriteSocket(hyper::Error),<br>&#125;<br></code></pre></td></tr></table></figure>

<p>When an error occurs, it might look like <code>DecodeMessage(serde_json: invalid character at 1)</code>. But this component might have 10 places that decode the message! How can we figure out in which step we see the invalid content?</p>
<p>So despite the error itself telling what has happened, if we want to have a clue on where this error occurs and if we should pay attention to it, we need the error to carry more information. For comparison, here is an example of an error log you might see from GreptimeDB.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Failed to handle protocol<br>0: Failed to handle incoming content, query: blabla, at src/protocol/handler.rs:89:22<br>1: Failed to reading next message at queue 5 of 10, at src/protocol/loop.rs:254:14<br>2: Failed to decode `01010001001010001` to ProtocolHeader, at src/protocol/codec.rs:90:14<br>3: serde_json(invalid character at position 1)<br></code></pre></td></tr></table></figure>

<p>A good error is not only about how it‚Äôs constructed, but more importantly is what will human see from it. We call it <strong>Stack Error</strong>. It should be intuitive and you must have seen a similar format elsewhere like backtrace.</p>
<p>From this log, it‚Äôs easy to know the entire thing with full context, from the user-facing behavior to the root cause. Plus the exact line and col number of where each error is propagated. And even gain a tiny report of this error: ‚Äúin the query ‚Äúblabla‚Äù, the fifth package‚Äôs header is corrupted‚Äù. It‚Äôs likely to be an invalid user input and we may not need to handle it from the server side.</p>
<p>This example shows the critical information that an error should contain (and contains in GreptimeDB):</p>
<ul>
<li>The root cause. Tells what‚Äôs happening.</li>
<li>The full context stack. For debugging or figuring out where this occurs.</li>
<li>What happens from the user‚Äôs perspective. Decide whether we need to expose this to user.</li>
</ul>
<p>The first root cause is often clear in many cases, like the <code>DecodeMessage</code> example before. Only if the library or function we used implements their error type correctly. But sometimes it isn‚Äôt quite helpful if we only have the root cause. Here is another <a target="_blank" rel="noopener" href="https://github.com/delta-incubator/delta-kernel-rs/pull/151">example</a> from DataBricks.</p>
<p>In the following sections, we will focus on the next two points and explain how it‚Äôs achieved. So hopefully you can achieve the same experience as in GreptimeDB.</p>
<h2 id="System-Backtrace"><a href="#System-Backtrace" class="headerlink" title="System Backtrace"></a>System Backtrace</h2><!-- toc:
- System Backtrace comes to help
- But backtrace has many problems -->

<p>So, now you have the root cause (<code>DecodeMessage(serde_json: invalid character at 1)</code>) but it‚Äôs not clear at which step this error occurs. Is decoding the header or body?</p>
<p>A natural thought is to capture the backtrace. In a causal where <code>.unwrap()</code> is the first choice, the backtrace will show up when error occurs (of course this is a bad practice). It will give you a complete call stack along with the line number. Then inspect the source code stack by stack, after skipping lots of unrelated system stacks, runtime stacks and std stacks, you finally get to the code you write.</p>
<p>Nowadays many libraries also provide the ability to capture backtrace on an <code>Error</code> is constructed. Regardless of whether the system backtrace can provide what we truly want, it‚Äôs very costly on either CPU (<a target="_blank" rel="noopener" href="https://github.com/GreptimeTeam/greptimedb/pull/1261">#1261</a>) and memory (<a target="_blank" rel="noopener" href="https://github.com/GreptimeTeam/greptimedb/pull/1273">#1273</a>). Capturing a backtrace will slow down your program as it needs to walk through the call stack and translate the pointer. Then to be able to translate the stack pointer we will need to include a large <code>debuginfo</code> in our binary. In GreptimeDB this means increasing the binary size by &gt; 700MB (4x size compared to 170MB without debuginfo). And there will be many noises in the captured system backtrace because the system can‚Äôt distinguish whether the code comes from the standard library, a third-party async runtime or our codebase.</p>
<p>There is another difference between the system backtrace and the proposed stack error. System backtrace tells us how to get to the position where the error occurs. While the stack error shows how the error is propagated. Sometimes there are different things. This difference comes from how the two things are implemented.</p>
<h2 id="Virtual-User-Stack"><a href="#Virtual-User-Stack" class="headerlink" title="Virtual User Stack"></a>Virtual User Stack</h2><!-- toc:
- Propose the virtual user stack, how does it look like
- The principle, and how it's added to errors -->

<p>Now let‚Äôs introduce the virtual user stack. The word ‚Äúvirtual‚Äù means the contrast of the system stack. Means it‚Äôs defined and constructed fully on user code. Look closer into the previous example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">1: Failed to reading next message at queue 5 of 10, at src/protocol/loop.rs:254:14<br></code></pre></td></tr></table></figure>

<p>A stack layer is composed of 3 parts. The first number represents its position in the entire stack. Then follows the description of this layer, which is the <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/fmt/trait.Display.html"><code>std::fmt::Display</code></a> implementation of that error. The last is corresponding code location. Rust provides <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/macro.file.html"><code>file!</code></a>, <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/macro.line.html"><code>line!</code></a> and <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/macro.column.html"><code>column!</code></a> macros to help get that information.</p>
<p>In practice, we utilize <a target="_blank" rel="noopener" href="https://docs.rs/snafu/0.8.2/snafu/struct.Location.html"><code>snafu::Location</code></a> to gather the code location. So each location points to where the error is constructed. Through this chain we know how this error is generated and propagated to the uppermost.</p>
<p>So here is what it looks like all together:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-meta">#[derive(Snafu)]</span><br><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Error</span></span> &#123;<br>    <span class="hljs-meta">#[snafu(display(<span class="hljs-meta-string">&quot;General catalog error: &quot;</span>))]</span> <span class="hljs-comment">// &lt;-- the `Display` impl deriv</span><br>    Catalog &#123;<br>        location: Location, <span class="hljs-comment">// &lt;-- the `location`</span><br>        source: catalog::error::Error, <span class="hljs-comment">// &lt;-- inner cause</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Then we implemented a proc-macro <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_macro/attr.stack_trace_debug.html"><code>stack_trace_debug</code></a> to scrape necessary information from <code>Error</code>‚Äòs definition and generate the implementation of the related trait <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_error/ext/trait.StackError.html"><code>StackError</code></a>, which provides useful methods to access and print the error:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">StackError</span></span>: std::error::Error &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">debug_fmt</span></span>(&amp;<span class="hljs-keyword">self</span>, layer: <span class="hljs-built_in">usize</span>, buf: &amp;<span class="hljs-keyword">mut</span> <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-built_in">String</span>&gt;);<br><br>    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">next</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; <span class="hljs-built_in">Option</span>&lt;&amp;<span class="hljs-keyword">dyn</span> StackError&gt;;<br><br>    <span class="hljs-comment">// Provided method</span><br>    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">last</span></span>(&amp;<span class="hljs-keyword">self</span>) -&gt; &amp;<span class="hljs-keyword">dyn</span> StackError<br>    <span class="hljs-keyword">where</span> <span class="hljs-keyword">Self</span>: <span class="hljs-built_in">Sized</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>By the way, we have added <code>Location</code> and <code>display</code> to all errors in GreptimeDB. This is the hard work behind the methodology.</p>
<h2 id="Macro-Details"><a href="#Macro-Details" class="headerlink" title="Macro Details"></a>Macro Details</h2><p>Error is a singly linked list, like an onion from outer to inner. So we can capture an error at the outermost and walk through it.</p>
<p>One tricky thing we did here is about how to distinguish internal and external errors. Internal errors all implement the same trait <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_error/ext/trait.ErrorExt.html"><code>ErrorExt</code></a> which can be used as a marker. But depending on this requires a <code>downcast</code> every time. We avoid this extra <code>downcast</code> call by simply giving a different name to them and detect in our macro. As shown below, we name all external errors <code>error</code> and all internal errors <code>source</code>. Then return <code>None</code> on implementing <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_error/ext/trait.StackError.html#tymethod.next"><code>StackError::next</code></a> method if we find an <code>error</code>, or <code>Some(source)</code> if we read <code>source</code>.</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs rust"><span class="hljs-meta">#[derive(Snafu)]</span><br><span class="hljs-meta">#[stack_trace_debug]</span><br><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Error</span></span> &#123;<br>    <span class="hljs-meta">#[snafu(display(<span class="hljs-meta-string">&quot;Failed to deserialize value&quot;</span>))]</span><br>    ValueDeserialize &#123;<br>        <span class="hljs-meta">#[snafu(source)]</span><br>        error: serde_json::error::Error, <span class="hljs-comment">// external source</span><br>        location: Location,<br>    &#125;,<br><br>    <span class="hljs-meta">#[snafu(display(<span class="hljs-meta-string">&quot;Table engine not found: &#123;&#125;&quot;</span>, engine_name))]</span><br>    TableEngineNotFound &#123;<br>        engine_name: <span class="hljs-built_in">String</span>,<br>        location: Location,<br>        source: table::error::Error, <span class="hljs-comment">// internal source</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The method <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_error/ext/trait.StackError.html#tymethod.debug_fmt"><code>StackError::debug_fmt</code></a> is used to render the error stack. It would be called recursively in the generated code. Each layer of error will write its own debug message to the mutable <code>buf</code>. The content will contain error description captured from <code>#[snafu(display)]</code> attribute, the variant arm type like <code>TableEngineNotFound</code> and the location from the enumeration.</p>
<p>Given we already defined our error types in that way, adopting stack error doesn‚Äôt require too much work, only adding the attribute macro <code>#[stack_trace_debug]</code> to every error type would be enough.</p>
<h2 id="Present-Error-to-End-User"><a href="#Present-Error-to-End-User" class="headerlink" title="Present Error to End User"></a>Present Error to End User</h2><p>So far we have done the most things. Here is the last piece about how to present the error to your user.</p>
<!-- toc:
- How error shows to users
- Distinguishing different errors, walk through the error chain -->

<p>Unlike the developer of your system, a user may not care about the line number and even the stack. But what information is helpful to end users?</p>
<p>This topic is very subjective. Our experience is that the leaf (or the innermost) error‚Äôs message might be useful as it is closer to what really goes wrong. The message can be further divided into two parts: internal and external, where the internal error is those defined in our codebase and the external is from dependencies, like <code>serde_json</code> from the previous example. And the root (or the outermost) error‚Äôs category is more accurate as it comes from where the error is thrown to the user. This can be achieved easily with previous <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_error/ext/trait.StackError.html#tymethod.next"><code>StackError::next</code></a> and <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_error/ext/trait.StackError.html#method.last"><code>StackError::last</code></a>. Or you can customize the format you want with those methods.</p>
<p>Combine them, here is the schema of our error that the user would see eventually:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">KIND - REASON ([EXTERNAL CAUSE])<br></code></pre></td></tr></table></figure>

<p>For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">Unexpected Message - Failed to decode `01010001001010001` to ProtocolHeader (serde_json(invalid character at position 1))<br></code></pre></td></tr></table></figure>

<!-- But our error here has carried many extra information than the standard library API defined: the source error, the location and the display. Moreover, we have to distinguish internal error (defined in GreptimeDB) and external error (defined elsewhere). -->

<h2 id="Cost"><a href="#Cost" class="headerlink" title="Cost?"></a>Cost?</h2><p>The virtual stack is sweety so far. And is cheaper and more accurate than the system backtrace. How much does it cost? </p>
<p>As for runtime overhead, it only requires some string format for the per-level reason and location.</p>
<p>And it‚Äôs even better on binary size. In GreptimeDB‚Äôs binary, the debug symbols occupied ~ 700MB, as a comparison the <code>strip</code>-ed binary size is around 170MB, with <code>.rodata</code> section size <code>016a2225</code> (~ 22.6M), the <code>.text</code> section occupies <code>06ad7511</code> (~ 106.8M).</p>
<p>Removing all <code>Location</code> reduces the <code>.rodata</code> size to <code>0169b225</code> and the overall binary size to 170MB. while removing all <code>#[snafu(display)]</code> reduces the <code>.rodata</code> size to <code>01690225</code> (~ 22.5M) and the overall binary size to 170MB. Hence this stack error mechanism‚Äôs overhead to binary size is very low (~ 100K).</p>
<h1 id="Conclusion-and-Future-Work"><a href="#Conclusion-and-Future-Work" class="headerlink" title="Conclusion and Future Work"></a>Conclusion and Future Work</h1><!-- toc:
- In the last, the test about binary size.
- We may consider making it more generic using the new std API -->

<p>In this post, we present how to implement a proc-macro <a target="_blank" rel="noopener" href="https://greptimedb.rs/common_macro/attr.stack_trace_debug.html"><code>stack_trace_debug</code></a> and use it to assemble a low-overhead and powerful stack error message. It also provides a convenient way to walk through the error chain, to help render the error in different schema for different purposes.</p>
<p>This macro is only adopted in GreptimeDB now, we are attempting to make it more generic for different projects. A wide adoption of this pattern can also make it even more powerful by bringing more third-party stacks and detailed reasons.</p>
<p>An unstable API <a target="_blank" rel="noopener" href="https://doc.rust-lang.org/std/error/trait.Error.html#method.provide"><code>provide</code></a> in std <code>Error</code> allows getting a field in a struct. It‚Äôs an option we can consider for refactoring our stack-trace utils.</p>
<p><em>Discussion on hackernews: <a target="_blank" rel="noopener" href="https://news.ycombinator.com/item?id=42457515">https://news.ycombinator.com/item?id=42457515</a></em></p>

        </article>
      </section>

      
      
        <nav class="article-nav">
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2024/07/datafusion-meetup-2024/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">Talk on DataFusion Meetup 2024</h2>
        </a>
      
      <div class="card-text--row">Newer</div>
    </div>
  </article>
</div>
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
      <div class="card-cover" background-image-lazy data-img="/covers/yukiguni.avif"></div>
    
    <div class="card-text">
      
        <a href="/2024/01/yukiguni/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">Èõ™ÂõΩ</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="https://github.com/waynexia.png" class="soft-size--round soft-style--box" alt="Wayne">
    
    
      <h2>Wayne</h2>
    
    

    <!-- <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>17</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        0
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        6
      </div>
    </div> -->

    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/waynexia/" class="soft-size--primary" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
          <a href="https://twitter.com/wayne17229928" class="soft-size--primary" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-twitter" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M962.285714 233.142857q-38.285714 56-92.571429 95.428571 0.571429 8 0.571429 24 0 74.285714-21.714286 148.285714t-66 142-105.428571 120.285714-147.428571 83.428571-184.571429 31.142857q-154.857143 0-283.428571-82.857143 20 2.285714 44.571429 2.285714 128.571429 0 229.142857-78.857143-60-1.142857-107.428571-36.857143t-65.142857-91.142857q18.857143 2.857143 34.857143 2.857143 24.571429 0 48.571429-6.285714-64-13.142857-106-63.714286t-42-117.428571l0-2.285714q38.857143 21.714286 83.428571 23.428571-37.714286-25.142857-60-65.714286t-22.285714-88q0-50.285714 25.142857-93.142857 69.142857 85.142857 168.285714 136.285714t212.285714 56.857143q-4.571429-21.714286-4.571429-42.285714 0-76.571429 54-130.571429t130.571429-54q80 0 134.857143 58.285714 62.285714-12 117.142857-44.571429-21.142857 65.714286-81.142857 101.714286 53.142857-5.714286 106.285714-28.571429z"></path>
</svg>
          </a>
        
      
        
          <a href="https://twitter.com/wayne17229928" class="soft-size--primary" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-mastodon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
  <path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"></path>
</svg>

          </a>
        
      
      
        <a rel="alternate" href="/atom.xml" title="Wonderland" type="application/atom+xml">
          <svg class="icon icon-rss" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
    <path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm64 120c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z"></path>
</svg>
        </a>
      
    </div>
     
    
  </div>
</section>

      <!--  -->

      <!-- <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
    </ul>
  </div>
</section> -->

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>Tags</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      <!-- <a href="/tags/Device/" style="font-size: 10px;" class="tags-cloud-0">Device</a> <a href="/tags/Experience/" style="font-size: 20px;" class="tags-cloud-10">Experience</a> <a href="/tags/Game/" style="font-size: 16.67px;" class="tags-cloud-7">Game</a> <a href="/tags/Paper-Reading/" style="font-size: 13.33px;" class="tags-cloud-3">Paper Reading</a> <a href="/tags/Rust/" style="font-size: 20px;" class="tags-cloud-10">Rust</a> <a href="/tags/Slides/" style="font-size: 13.33px;" class="tags-cloud-3">Slides</a> -->
      
          <a href="/tags/Paper-Reading/">
            Paper Reading (2)
          </a>
      
          <a href="/tags/Rust/">
            Rust (5)
          </a>
      
          <a href="/tags/Experience/">
            Experience (5)
          </a>
      
          <a href="/tags/Game/">
            Game (3)
          </a>
      
          <a href="/tags/Slides/">
            Slides (2)
          </a>
      
          <a href="/tags/Device/">
            Device (1)
          </a>
      
    </div>
  </div>
</section>

      <!-- todo: only sticky TOC list -->
      
<section class="widget-toc widget-item layout-margin content-padding--primary soft-size--large soft-style--box sticky_element">
  <div class="widget-title">
    <svg class="icon icon-toc" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M134.50666666 767.46666668H460.8c27.73333333 0 50.24000001 22.50666668 50.24000001 50.23999999v50.13333333c0 27.73333333-22.50666668 50.24000001-50.24000001 50.24000001H134.50666666c-27.73333333 0-50.24000001-22.50666668-50.23999999-50.24000001v-50.13333333c0.10666668-27.73333333 22.50666668-50.24000001 50.24000001-50.24000001zM84.37333332 541.65333333h326.18666669c27.73333333 0 50.24000001 22.39999999 50.23999999 50.13333334v50.24000001c0 27.73333333-22.50666668 50.24000001-50.24000002 50.23999999H84.37333332c-27.73333333 0-50.24000001-22.50666668-50.23999999-50.23999999v-50.24000001c0-27.73333333 22.50666668-50.13333334 50.24000001-50.13333334zM134.50666666 315.83999999H460.8c27.73333333 0 50.24000001 22.50666668 50.24000001 50.24000001v50.24000001c0 27.73333333-22.50666668 50.13333334-50.24000001 50.13333333H134.50666666c-27.73333333 0-50.24000001-22.39999999-50.23999999-50.13333333v-50.24000001c0.10666668-27.84000001 22.50666668-50.24000001 50.24000001-50.23999999zM209.81333332 89.91999999h326.18666671c27.73333333 0 50.24000001 22.39999999 50.23999997 50.13333335v50.23999999c0 27.73333333-22.50666668 50.24000001-50.24000001 50.24000001H209.81333332c-27.73333333 0-50.24000001-22.50666668-50.23999999-50.24000001v-50.24000001c0-27.73333333 22.50666668-50.13333334 50.24000001-50.13333333zM692.05333333 623.36l274.66666669 176.00000002c23.36000001 14.93333333 30.08 45.97333334 15.14666666 69.33333332L954.77333334 910.93333333c-14.93333333 23.25333334-45.97333334 30.08-69.33333335 15.14666667l-274.66666666-176c-23.36000001-14.93333333-30.08-45.97333334-15.14666667-69.33333333l27.09333334-42.24000001c14.93333333-23.36000001 46.08000001-30.08 69.33333333-15.14666666z" fill="currentColor"></path>
</svg>
    <span>Content</span>
  </div>
  <div class="widget-body">
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduce"><span class="toc-text">Introduce</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-Error-is-in-Rust"><span class="toc-text">What Error is in Rust</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ecosystem-at-present"><span class="toc-text">Ecosystem at present</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Stacking-Error"><span class="toc-text">Stacking Error</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#What-we-want-from-error"><span class="toc-text">What we want from error</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#System-Backtrace"><span class="toc-text">System Backtrace</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Virtual-User-Stack"><span class="toc-text">Virtual User Stack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Macro-Details"><span class="toc-text">Macro Details</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Present-Error-to-End-User"><span class="toc-text">Present Error to End User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cost"><span class="toc-text">Cost?</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion-and-Future-Work"><span class="toc-text">Conclusion and Future Work</span></a></li></ol>
  </div>
</section>


    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    <p>
      &copy; 2024 <a href="/" target="_blank">Wayne</a>
      
        |
        <a rel="alternate" href="/atom.xml" title="Wonderland" type="application/atom+xml">
          <svg class="icon icon-rss" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
    <path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm64 120c0 17.7-14.3 32-32 32s-32-14.3-32-32s14.3-32 32-32s32 14.3 32 32z"></path>
</svg>
        </a>
      
    </p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> - <a href="https://github.com/waynexia/flexblock-modified" target="_blank" rel="noopener noreferrer author">This theme</a> is customized from <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <script data-goatcounter="https://waynest.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- Â∞æÈÉ®Áî®Êà∑Ëá™ÂÆö‰πâÁõ∏ÂÖ≥ÂÜÖÂÆπ -->
</body>
</html>